<html><head><title>Module Lwt_unix </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="text/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="Lwt_unix lwt"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Lwt</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p class="mainmenu-current"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../deriving/" class="ocsimore_phrasing_link">deriving</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1>Lwt - API Reference</h1><h2>Core library</h2><h3><a href=".././api/Lwt" class="ocsimore_phrasing_link">Lwt</a></h3><h3><a href=".././api/Lwt_condition" class="ocsimore_phrasing_link">Lwt_condition</a></h3><h3><a href=".././api/Lwt_list" class="ocsimore_phrasing_link">Lwt_list</a></h3><h3><a href=".././api/Lwt_mutex" class="ocsimore_phrasing_link">Lwt_mutex</a></h3><h3><a href=".././api/Lwt_mvar" class="ocsimore_phrasing_link">Lwt_mvar</a></h3><h3><a href=".././api/Lwt_pool" class="ocsimore_phrasing_link">Lwt_pool</a></h3><h3><a href=".././api/Lwt_sequence" class="ocsimore_phrasing_link">Lwt_sequence</a></h3><h3><a href=".././api/Lwt_stream" class="ocsimore_phrasing_link">Lwt_stream</a></h3><h3><a href=".././api/Lwt_switch" class="ocsimore_phrasing_link">Lwt_switch</a></h3><h2>Unix bindings</h2><h3><a href=".././api/Lwt_daemon" class="ocsimore_phrasing_link">Lwt_daemon</a></h3><h3><a href=".././api/Lwt_gc" class="ocsimore_phrasing_link">Lwt_gc</a></h3><h3><a href=".././api/Lwt_io" class="ocsimore_phrasing_link">Lwt_io</a></h3><h3><a href=".././api/Lwt_log" class="ocsimore_phrasing_link">Lwt_log</a></h3><h3><a href=".././api/Lwt_main" class="ocsimore_phrasing_link">Lwt_main</a></h3><h3><a href=".././api/Lwt_process" class="ocsimore_phrasing_link">Lwt_process</a></h3><h3><a href=".././api/Lwt_throttle" class="ocsimore_phrasing_link">Lwt_throttle</a></h3><h3><a href=".././api/Lwt_timeout" class="ocsimore_phrasing_link">Lwt_timeout</a></h3><h3><a href=".././api/Lwt_unix" class="ocsimore_phrasing_link">Lwt_unix</a></h3><h3><a href=".././api/Lwt_bytes" class="ocsimore_phrasing_link">Lwt_bytes</a></h3><h2>Reactive programming helpers</h2><h3><a href=".././api/Lwt_event" class="ocsimore_phrasing_link">Lwt_event</a></h3><h3><a href=".././api/Lwt_signal" class="ocsimore_phrasing_link">Lwt_signal</a></h3><h2>Syntax extensions</h2><h3><a href=".././api/Pa_lwt" class="ocsimore_phrasing_link">Pa_lwt</a></h3><h3><a href=".././api/Pa_lwt_log" class="ocsimore_phrasing_link">Pa_lwt_log</a></h3><h2>Terminal manipulation</h2><h3><a href=".././api/Lwt_read_line" class="ocsimore_phrasing_link">Lwt_read_line</a></h3><h3><a href=".././api/Lwt_term" class="ocsimore_phrasing_link">Lwt_term</a></h3><h3><a href=".././api/Lwt_text" class="ocsimore_phrasing_link">Lwt_text</a></h3><h2>Miscellaneous</h2><h3><a href=".././api/Lwt_glib" class="ocsimore_phrasing_link">Lwt_glib</a></h3><h3><a href=".././api/Lwt_lib" class="ocsimore_phrasing_link">Lwt_lib</a></h3><h3><a href=".././api/Lwt_preemptive" class="ocsimore_phrasing_link">Lwt_preemptive</a></h3><h3><a href=".././api/Lwt_ssl" class="ocsimore_phrasing_link">Lwt_ssl</a></h3><h2>Index</h2></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../1.0.0/api/Lwt_unix">1.0.0</option><option value=".././../1.1.0/api/Lwt_unix">1.1.0</option><option value=".././../2.0.0/api/Lwt_unix">2.0.0</option><option value=".././../2.1.0/api/Lwt_unix">2.1.0</option><option value=".././../2.1.1/api/Lwt_unix">2.1.1</option><option value=".././../2.2.0/api/Lwt_unix">2.2.0</option><option value=".././../2.2.1/api/Lwt_unix" selected="selected">2.2.1</option><option value=".././../2.3.0/api/Lwt_unix">2.3.0</option><option value=".././../2.3.1/api/Lwt_unix">2.3.1</option><option value=".././../2.3.2/api/Lwt_unix">2.3.2</option><option value=".././../2.4.0/api/Lwt_unix">2.4.0</option><option value=".././../2.4.1/api/Lwt_unix">2.4.1</option><option value=".././../2.4.2/api/Lwt_unix">2.4.2</option><option value=".././../2.4.3/api/Lwt_unix">2.4.3</option><option value=".././../2.4.7/api/Lwt_unix">2.4.7</option><option value=".././../2.4.8/api/Lwt_unix">2.4.8</option><option value=".././../2.5.0/api/Lwt_unix">2.5.0</option><option value=".././../2.5.1/api/Lwt_unix">2.5.1</option><option value=".././../2.5.2/api/Lwt_unix">2.5.2</option><option value=".././../2.6.0/api/Lwt_unix">2.6.0</option><option value=".././../2.7.0/api/Lwt_unix">2.7.0</option><option value=".././../2.7.1/api/Lwt_unix">2.7.1</option><option value=".././../3.0.0/api/Lwt_unix">3.0.0</option><option value=".././../3.1.0/api/Lwt_unix">3.1.0</option><option value=".././../3.2.1/api/Lwt_unix">3.2.1</option><option value=".././../3.3.0/api/Lwt_unix">3.3.0</option><option value=".././../4.0.0/api/Lwt_unix">4.0.0</option><option value=".././../4.0.1/api/Lwt_unix">4.0.1</option><option value=".././../4.1.0/api/Lwt_unix">4.1.0</option><option value=".././../4.2.0/api/Lwt_unix">4.2.0</option><option value=".././../4.2.1/api/Lwt_unix">4.2.1</option><option value=".././../4.3.0/api/Lwt_unix">4.3.0</option><option value=".././../4.3.1/api/Lwt_unix">4.3.1</option><option value=".././../4.4.0/api/Lwt_unix">4.4.0</option><option value=".././../4.5.0/api/Lwt_unix">4.5.0</option><option value=".././../5.0.0/api/Lwt_unix">5.0.0</option><option value=".././../5.0.1/api/Lwt_unix">5.0.1</option><option value=".././../5.1.0/api/Lwt_unix">5.1.0</option><option value=".././../5.1.1/api/Lwt_unix">5.1.1</option><option value=".././../5.1.2/api/Lwt_unix">5.1.2</option><option value=".././../5.2.0/api/Lwt_unix">5.2.0</option><option value=".././../5.3.0/api/Lwt_unix">5.3.0</option><option value=".././../5.4.0/api/Lwt_unix">5.4.0</option><option value=".././../5.4.1/api/Lwt_unix">5.4.1</option><option value=".././../5.4.2/api/Lwt_unix">5.4.2</option><option value=".././../5.5.0/api/Lwt_unix">5.5.0</option><option value=".././../dev/api/Lwt_unix">dev</option></select><nav class="how-doctree"><h1>Lwt - API Reference</h1><h2>Core library</h2><h3><a href=".././api/Lwt" class="ocsimore_phrasing_link">Lwt</a></h3><h3><a href=".././api/Lwt_condition" class="ocsimore_phrasing_link">Lwt_condition</a></h3><h3><a href=".././api/Lwt_list" class="ocsimore_phrasing_link">Lwt_list</a></h3><h3><a href=".././api/Lwt_mutex" class="ocsimore_phrasing_link">Lwt_mutex</a></h3><h3><a href=".././api/Lwt_mvar" class="ocsimore_phrasing_link">Lwt_mvar</a></h3><h3><a href=".././api/Lwt_pool" class="ocsimore_phrasing_link">Lwt_pool</a></h3><h3><a href=".././api/Lwt_sequence" class="ocsimore_phrasing_link">Lwt_sequence</a></h3><h3><a href=".././api/Lwt_stream" class="ocsimore_phrasing_link">Lwt_stream</a></h3><h3><a href=".././api/Lwt_switch" class="ocsimore_phrasing_link">Lwt_switch</a></h3><h2>Unix bindings</h2><h3><a href=".././api/Lwt_daemon" class="ocsimore_phrasing_link">Lwt_daemon</a></h3><h3><a href=".././api/Lwt_gc" class="ocsimore_phrasing_link">Lwt_gc</a></h3><h3><a href=".././api/Lwt_io" class="ocsimore_phrasing_link">Lwt_io</a></h3><h3><a href=".././api/Lwt_log" class="ocsimore_phrasing_link">Lwt_log</a></h3><h3><a href=".././api/Lwt_main" class="ocsimore_phrasing_link">Lwt_main</a></h3><h3><a href=".././api/Lwt_process" class="ocsimore_phrasing_link">Lwt_process</a></h3><h3><a href=".././api/Lwt_throttle" class="ocsimore_phrasing_link">Lwt_throttle</a></h3><h3><a href=".././api/Lwt_timeout" class="ocsimore_phrasing_link">Lwt_timeout</a></h3><h3><a href=".././api/Lwt_unix" class="ocsimore_phrasing_link">Lwt_unix</a></h3><h3><a href=".././api/Lwt_bytes" class="ocsimore_phrasing_link">Lwt_bytes</a></h3><h2>Reactive programming helpers</h2><h3><a href=".././api/Lwt_event" class="ocsimore_phrasing_link">Lwt_event</a></h3><h3><a href=".././api/Lwt_signal" class="ocsimore_phrasing_link">Lwt_signal</a></h3><h2>Syntax extensions</h2><h3><a href=".././api/Pa_lwt" class="ocsimore_phrasing_link">Pa_lwt</a></h3><h3><a href=".././api/Pa_lwt_log" class="ocsimore_phrasing_link">Pa_lwt_log</a></h3><h2>Terminal manipulation</h2><h3><a href=".././api/Lwt_read_line" class="ocsimore_phrasing_link">Lwt_read_line</a></h3><h3><a href=".././api/Lwt_term" class="ocsimore_phrasing_link">Lwt_term</a></h3><h3><a href=".././api/Lwt_text" class="ocsimore_phrasing_link">Lwt_text</a></h3><h2>Miscellaneous</h2><h3><a href=".././api/Lwt_glib" class="ocsimore_phrasing_link">Lwt_glib</a></h3><h3><a href=".././api/Lwt_lib" class="ocsimore_phrasing_link">Lwt_lib</a></h3><h3><a href=".././api/Lwt_preemptive" class="ocsimore_phrasing_link">Lwt_preemptive</a></h3><h3><a href=".././api/Lwt_ssl" class="ocsimore_phrasing_link">Lwt_ssl</a></h3><h2>Index</h2></nav></nav><article class="rightcol"><h1>Module <span><a href=".././api/Lwt_unix">Lwt_unix</a></span> </h1><div class="code"><p><span class="keyword">module</span> Lwt_unix: <span class="code">sig</span><span><a href=".././api/Lwt_unix">..</a></span><span class="code">end</span></p></div><p>Cooperative system calls<br/>
</p><hr/><p><br/>
This modules redefine system calls, as in the <span class="code">Unix</span> module of the
standard library, but mapped into cooperative ones, which will not
block the program, letting other threads run.<br/>
</p><p>The semantic of all operations is the following: if the action
(for example reading from a <strong>file descriptor</strong>) can be performed
immediatly, it is done and returns immediatly, otherwise it
returns a sleeping threads which is waked up when the operation
completes.<br/>
</p><p>Moreover all sleeping threads returned by function of this modules
are <strong>cancelable</strong>, this means that you can cancel them with
<span><a href=".././api/Lwt#VALcancel">Lwt.cancel</a></span>. For example if you want to read something from a <strong>    file descriptor</strong> with a timeout, you can cancel the action after
the timeout and the reading will not be performed if not already
done.<br/>
</p><p>More precisely, assuming that you have two <strong>file descriptor</strong>
<span class="code">fd1</span> and <span class="code">fd2</span> and you want to read something from <span class="code">fd1</span> or
exclusively from <span class="code">fd2</span>, and fail with an exception if a timeout of
1 second expires, without reading anything from <span class="code">fd1</span> and <span class="code">fd2</span>,
even if they become readable in the future.<br/>
</p><p>Then you can do:<br/>
</p><p>
</p><pre>      Lwt.pick [Lwt_unix.timeout 1.0; read fd1 buf1 ofs1 len1; read fd2 buf2 ofs2 len2]
    
</pre><p><br/>
</p><p>In this case it is guaranteed that exactly one of the three
operations will completes, and other will just be cancelled.<br/>
</p><div class="code" id="VALhandle_unix_error"><p><span class="keyword">val</span> handle_unix_error : <span class="code type">('a -&gt; 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a -&gt; 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Same as <span class="code">Unix.handle_unix_error</span> but catches lwt-level
exceptions<br/></p></div><p><br/>
</p><h6 id="6_Configuration">Configuration <a class="backref" href="#6_Configuration">&#182;</a></h6><p><br/>
</p><div class="code" id="TYPEasync_method"><p><span class="keyword">type</span> async_method = 
</p><table class="typetable"><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Async_none</span></td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">System calls are made synchronously, and may block the
entire program.</td><td class="typefieldcomment leftbottom endcom"><span class="teletype">*)</span></td></tr><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Async_detach</span></td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">System calls are made in another system thread, thus without
blocking other Lwt threads. The drawback is that it may
degrade performances in some cases.<br/>
</td></tr></table><p>This is the default.|@@class=&quot;typefieldcomment leftbottom endcom&quot;@@<span class="teletype">*)</span>|
</p><table><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Async_switch</span></td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">System calls are made in the main thread, and if one blocks
the execution continue in another system thread. This method
is the most efficint, also you will get better performances
if you force all threads to run on the same cpu. On linux
this can be done by using the command <span class="code">taskset</span>.<br/>
</td></tr></table><p>Note that this method is still experimental.|@@class=&quot;typefieldcomment leftbottom endcom&quot;@@<span class="teletype">*)</span>|</p></div><div class="info"><p>For system calls that cannot be made asynchronously, Lwt uses one
of the following method:<br/></p></div><div class="code" id="VALdefault_async_method"><p><span class="keyword">val</span> default_async_method : <span class="code type">unit -&gt; <span><a href=".././api/Lwt_unix#TYPEasync_method">async_method</a></span></span></p></div><div class="info"><p>Returns the default async method.<br/>
</p><p>This can be initialized using the environment variable
<span class="code">&quot;LWT_ASYNC_METHOD&quot;</span> with possible values <span class="code">&quot;none&quot;</span>,
<span class="code">&quot;detach&quot;</span> and <span class="code">&quot;switch&quot;</span>.<br/></p></div><div class="code" id="VALset_default_async_method"><p><span class="keyword">val</span> set_default_async_method : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEasync_method">async_method</a></span> -&gt; unit</span></p></div><div class="info"><p>Sets the default async method.<br/></p></div><div class="code" id="VALasync_method"><p><span class="keyword">val</span> async_method : <span class="code type">unit -&gt; <span><a href=".././api/Lwt_unix#TYPEasync_method">async_method</a></span></span></p></div><div class="info"><p><span class="code">async_method ()</span> returns the async method used in the current
thread.<br/></p></div><div class="code" id="VALasync_method_key"><p><span class="keyword">val</span> async_method_key : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEasync_method">async_method</a></span> <span><a href=".././api/Lwt#TYPEkey">Lwt.key</a></span></span></p></div><div class="info"><p>The key for storing the local async method.<br/></p></div><div class="code" id="VALwith_async_none"><p><span class="keyword">val</span> with_async_none : <span class="code type">(unit -&gt; 'a) -&gt; 'a</span></p></div><div class="info"><p><span class="code">with_async_none f</span> is a shorthand for:<br/>
</p><p>
</p><pre>        Lwt.with_value async_method_key (Some Async_none) f
      
</pre><p><br/></p></div><div class="code" id="VALwith_async_detach"><p><span class="keyword">val</span> with_async_detach : <span class="code type">(unit -&gt; 'a) -&gt; 'a</span></p></div><div class="info"><p><span class="code">with_async_none f</span> is a shorthand for:<br/>
</p><p>
</p><pre>        Lwt.with_value async_method_key (Some Async_detach) f
      
</pre><p><br/></p></div><div class="code" id="VALwith_async_switch"><p><span class="keyword">val</span> with_async_switch : <span class="code type">(unit -&gt; 'a) -&gt; 'a</span></p></div><div class="info"><p><span class="code">with_async_none f</span> is a shorthand for:<br/>
</p><p>
</p><pre>        Lwt.with_value async_method_key (Some Async_switch) f
      
</pre><p><br/></p></div><p><br/>
</p><h6 id="6_Sleeping">Sleeping <a class="backref" href="#6_Sleeping">&#182;</a></h6><p><br/>
</p><div class="code" id="VALsleep"><p><span class="keyword">val</span> sleep : <span class="code type">float -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">sleep d</span> is a threads which remain suspended for <span class="code">d</span> seconds
and then terminates.<br/></p></div><div class="code" id="VALyield"><p><span class="keyword">val</span> yield : <span class="code type">unit -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">yield ()</span> is a threads which suspends itself and then resumes
as soon as possible and terminates.<br/></p></div><div class="code" id="VALauto_yield"><p><span class="keyword">val</span> auto_yield : <span class="code type">float -&gt; unit -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">auto_yield timeout</span> returns a function <span class="code">f</span> which will yield
every <span class="code">timeout</span> seconds.<br/></p></div><div class="code" id="EXCEPTIONTimeout"><p><span class="keyword">exception</span> Timeout</p></div><div class="info"><p>Exception raised by timeout operations<br/></p></div><div class="code" id="VALtimeout"><p><span class="keyword">val</span> timeout : <span class="code type">float -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">timeout d</span> is a threads which remain suspended for <span class="code">d</span> seconds
then fail with <span><a href=".././api/Lwt_unix#EXCEPTIONTimeout">Lwt_unix.Timeout</a></span><br/></p></div><div class="code" id="VALwith_timeout"><p><span class="keyword">val</span> with_timeout : <span class="code type">float -&gt; (unit -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">with_timeout d f</span> is a short-hand for:<br/>
</p><p>
</p><pre>        Lwt.pick [Lwt_unix.timeout d; f ()]
      
</pre><p><br/></p></div><p><br/>
</p><h6 id="6_Operationonfiledescriptors">Operation on file-descriptors <a class="backref" href="#6_Operationonfiledescriptors">&#182;</a></h6><p><br/>
</p><div class="code" id="TYPEfile_descr"><p><span class="keyword">type</span> file_descr</p></div><div class="info"><p>The abstract type for <strong>file descriptor</strong>s. A Lwt <strong>file
descriptor</strong> is a pair of a unix <strong>file descriptor</strong> (of type
<span class="code">Unix.file_descr</span>) and a <strong>state</strong>.<br/>
</p><p>A <strong>file descriptor</strong> may be:<br/>
</p><ul><li> <strong>opened</strong>, in which case it is fully usable
</li><li> <strong>closed</strong> or <strong>aborted</strong>, in which case it is no longer
usable
</li></ul><p><br/></p></div><div class="code" id="TYPEstate"><p><span class="keyword">type</span> state = 
</p><table class="typetable"><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Opened</span></td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">The <strong>file descriptor</strong> is opened</td><td class="typefieldcomment leftbottom endcom"><span class="teletype">*)</span></td></tr><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Closed</span></td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">The <strong>file descriptor</strong> has been closed by <span><a href=".././api/Lwt_unix#VALclose">Lwt_unix.close</a></span>. It must
not be used for any operation.</td><td class="typefieldcomment leftbottom endcom"><span class="teletype">*)</span></td></tr><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Aborted</span> <span class="keyword">of</span> <span class="code type">exn</span></td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">The <strong>file descriptor</strong> has been aborted, the only operation
possible is <span><a href=".././api/Lwt_unix#VALclose">Lwt_unix.close</a></span>, all others will fail.</td><td class="typefieldcomment leftbottom endcom"><span class="teletype">*)</span></td></tr></table></div><div class="info"><p>State of a <strong>file descriptor</strong><br/></p></div><div class="code" id="VALstate"><p><span class="keyword">val</span> state : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; <span><a href=".././api/Lwt_unix#TYPEstate">state</a></span></span></p></div><div class="info"><p><span class="code">state fd</span> returns the state of <span class="code">fd</span><br/></p></div><div class="code" id="VALunix_file_descr"><p><span class="keyword">val</span> unix_file_descr : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.file_descr</span></p></div><div class="info"><p>Returns the underlying unix <strong>file descriptor</strong>. It always
succeed, even if the <strong>file descriptor</strong>'s state is not
<span class="code">Open</span>.<br/></p></div><div class="code" id="VALof_unix_file_descr"><p><span class="keyword">val</span> of_unix_file_descr : <span class="code type">?blocking:bool -&gt; ?set_flags:bool -&gt; Unix.file_descr -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p>Creates a lwt <strong>file descriptor</strong> from a unix one.<br/>
</p><p><span class="code">blocking</span> is the blocking mode of the file-descriptor, it
describe how Lwt will use it. In non-blocking mode, read/write
on this file descriptor are made using non-blocking IO; in
blocking mode they are made using the current async method.  If
<span class="code">blocking</span> is not specified it is guessed according to the file
kind: socket and pipes are in non-blocking mode and others are
in blocking mode.<br/>
</p><p>If <span class="code">set_flags</span> is <span class="code">true</span> (the default) then the file flags are
modified according to the <span class="code">blocking</span> argument, otherwise they
are left unchanged.<br/>
</p><p>Note that the blocking mode is less efficient than the
non-blocking one, so it should be used only for file descriptors
that does not support asynchronous operations, such as regular
files, or for shared descriptors such as <span><a href=".././api/Lwt_unix#VALstdout">Lwt_unix.stdout</a></span>, <span><a href=".././api/Lwt_unix#VALstderr">Lwt_unix.stderr</a></span> or
<span><a href=".././api/Lwt_unix#VALstdin">Lwt_unix.stdin</a></span>.<br/></p></div><div class="code" id="VALblocking"><p><span class="keyword">val</span> blocking : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; bool <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">blocking fd</span> returns whether <span class="code">fd</span> is used in blocking or
non-blocking mode.<br/></p></div><div class="code" id="VALset_blocking"><p><span class="keyword">val</span> set_blocking : <span class="code type">?set_flags:bool -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; bool -&gt; unit</span></p></div><div class="info"><p><span class="code">set_blocking fd b</span> puts <span class="code">fd</span> in blocking or non-blocking
mode. If <span class="code">set_flags</span> is <span class="code">true</span> (the default) then the file flags
are modified, otherwise the modification is only done at the
application level.<br/></p></div><div class="code" id="VALabort"><p><span class="keyword">val</span> abort : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; exn -&gt; unit</span></p></div><div class="info"><p><span class="code">abort fd exn</span> makes all current and further uses of the file
descriptor fail with the given exception. This put the <strong>file
descriptor</strong> into the <span class="code">Aborted</span> state.<br/>
</p><p>If the <strong>file descrptor</strong> is closed, this does nothing, if it is
aborted, this replace the abort exception by <span class="code">exn</span>.<br/></p></div><p><br/>
</p><h6 id="6_Processhandling">Process handling <a class="backref" href="#6_Processhandling">&#182;</a></h6><p><br/>
</p><div class="code" id="VALwait"><p><span class="keyword">val</span> wait : <span class="code type">unit -&gt; (int * Unix.process_status) <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.wait</span><br/></p></div><div class="code" id="VALwaitpid"><p><span class="keyword">val</span> waitpid : <span class="code type">Unix.wait_flag list -&gt; int -&gt; (int * Unix.process_status) <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.waitpid</span><br/></p></div><div class="code" id="TYPEresource_usage"><p><span class="keyword">type</span> resource_usage = { 
</p><table class="typetable"><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">ru_utime : <span class="code type">float</span>;</td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">User time used</td><td class="typefieldcomment leftbottom endcom"><span class="teletype">*)</span></td></tr><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">ru_stime : <span class="code type">float</span>;</td><td class="typefieldcomment lefttop startcom"><span class="teletype">(*</span></td><td class="typefieldcomment lefttop">System time used</td><td class="typefieldcomment leftbottom endcom"><span class="teletype">*)</span></td></tr></table><p>}</p></div><div class="info"><p>Resource usages<br/></p></div><div class="code" id="VALwait4"><p><span class="keyword">val</span> wait4 : <span class="code type"><br/><span class="teletype">   </span>Unix.wait_flag list -&gt;<br/><span class="teletype">   </span>  int -&gt; (int * Unix.process_status * <span><a href=".././api/Lwt_unix#TYPEresource_usage">resource_usage</a></span>) <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">wait4 flags pid</span> returns <span class="code">(pid, status, rusage)</span> where <span class="code">(pid,
status)</span> is the same result as <span class="code">Unix.waitpid flags pid</span>, and
<span class="code">rusage</span> contains accounting information about the child.<br/></p></div><div class="code" id="VALhas_wait4"><p><span class="keyword">val</span> has_wait4 : <span class="code type">bool</span></p></div><div class="info"><p>Whether the <span class="code">wait4</span> system call is available on this system. If
it is not, them <span class="code">wait4</span> will always returns <span class="code">{ utime = 0.0;
stime = 0.0 }</span> as resource usages.<br/></p></div><div class="code" id="VALsystem"><p><span class="keyword">val</span> system : <span class="code type">string -&gt; Unix.process_status <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.system</span><br/></p></div><p><br/>
</p><h6 id="6_Basicfileinputoutput">Basic file input/output <a class="backref" href="#6_Basicfileinputoutput">&#182;</a></h6><p><br/>
</p><div class="code" id="VALstdin"><p><span class="keyword">val</span> stdin : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p>The standard <strong>file descriptor</strong> for input. This one is usually
a terminal is the program is started from a terminal.<br/></p></div><div class="code" id="VALstdout"><p><span class="keyword">val</span> stdout : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p>The standard <strong>file descriptor</strong> for output<br/></p></div><div class="code" id="VALstderr"><p><span class="keyword">val</span> stderr : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p>The standard <strong>file descriptor</strong> for printing error messages<br/></p></div><div class="code" id="VALopenfile"><p><span class="keyword">val</span> openfile : <span class="code type">string -&gt; Unix.open_flag list -&gt; Unix.file_perm -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.openfile</span>.<br/></p></div><div class="code" id="VALclose"><p><span class="keyword">val</span> close : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Close a <strong>file descriptor</strong>. This close the underlying unix <strong>      file descriptor</strong> and set its state to <span class="code">Closed</span><br/></p></div><div class="code" id="VALread"><p><span class="keyword">val</span> read : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; string -&gt; int -&gt; int -&gt; int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">read fd buf ofs len</span> has the same semantic as <span class="code">Unix.read</span>, but
is cooperative<br/></p></div><div class="code" id="VALwrite"><p><span class="keyword">val</span> write : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; string -&gt; int -&gt; int -&gt; int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">read fd buf ofs len</span> has the same semantic as <span class="code">Unix.write</span>, but
is cooperative<br/></p></div><div class="code" id="VALreadable"><p><span class="keyword">val</span> readable : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; bool</span></p></div><div class="info"><p>Returns whether the given file descriptor is currently
readable.<br/></p></div><div class="code" id="VALwritable"><p><span class="keyword">val</span> writable : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; bool</span></p></div><div class="info"><p>Returns whether the given file descriptor is currently
writable.<br/></p></div><div class="code" id="VALwait_read"><p><span class="keyword">val</span> wait_read : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>waits (without blocking other threads) until there is something
to read on the file descriptor<br/></p></div><div class="code" id="VALwait_write"><p><span class="keyword">val</span> wait_write : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>waits (without blocking other threads) until it is possible to
write on the file descriptor<br/></p></div><p><br/>
</p><h6 id="6_Seekingandtruncating">Seeking and truncating <a class="backref" href="#6_Seekingandtruncating">&#182;</a></h6><p><br/>
</p><div class="code" id="VALlseek"><p><span class="keyword">val</span> lseek : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; int -&gt; Unix.seek_command -&gt; int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.lseek</span><br/></p></div><div class="code" id="VALtruncate"><p><span class="keyword">val</span> truncate : <span class="code type">string -&gt; int -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.truncate</span><br/></p></div><div class="code" id="VALftruncate"><p><span class="keyword">val</span> ftruncate : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; int -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.ftruncate</span><br/></p></div><p><br/>
</p><h6 id="6_Filestatus">File status <a class="backref" href="#6_Filestatus">&#182;</a></h6><p><br/>
</p><div class="code" id="VALstat"><p><span class="keyword">val</span> stat : <span class="code type">string -&gt; Unix.stats <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.stat</span><br/></p></div><div class="code" id="VALlstat"><p><span class="keyword">val</span> lstat : <span class="code type">string -&gt; Unix.stats <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.lstat</span><br/></p></div><div class="code" id="VALfstat"><p><span class="keyword">val</span> fstat : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.stats <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.fstat</span><br/></p></div><div class="code" id="VALisatty"><p><span class="keyword">val</span> isatty : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; bool <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.isatty</span><br/></p></div><p><br/>
</p><h6 id="6_Fileoperationsonlargefiles">File operations on large files <a class="backref" href="#6_Fileoperationsonlargefiles">&#182;</a></h6><p><br/>
</p><div class="code"><p><span class="keyword">module</span> <span><a href=".././api/Lwt_unix.LargeFile">LargeFile</a></span>: <span class="code">sig</span><span><a href=".././api/Lwt_unix.LargeFile">..</a></span><span class="code">end</span></p></div><p><br/>
</p><h6 id="6_Operationsonfilenames">Operations on file names <a class="backref" href="#6_Operationsonfilenames">&#182;</a></h6><p><br/>
</p><div class="code" id="VALunlink"><p><span class="keyword">val</span> unlink : <span class="code type">string -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.unlink</span><br/></p></div><div class="code" id="VALrename"><p><span class="keyword">val</span> rename : <span class="code type">string -&gt; string -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.rename</span><br/></p></div><div class="code" id="VALlink"><p><span class="keyword">val</span> link : <span class="code type">string -&gt; string -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.link</span><br/></p></div><p><br/>
</p><h6 id="6_Filepermissionsandownership">File permissions and ownership <a class="backref" href="#6_Filepermissionsandownership">&#182;</a></h6><p><br/>
</p><div class="code" id="VALchmod"><p><span class="keyword">val</span> chmod : <span class="code type">string -&gt; Unix.file_perm -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.chmod</span><br/></p></div><div class="code" id="VALfchmod"><p><span class="keyword">val</span> fchmod : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.file_perm -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.fchmod</span><br/></p></div><div class="code" id="VALchown"><p><span class="keyword">val</span> chown : <span class="code type">string -&gt; int -&gt; int -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.chown</span><br/></p></div><div class="code" id="VALfchown"><p><span class="keyword">val</span> fchown : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; int -&gt; int -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.fchown</span><br/></p></div><div class="code" id="VALaccess"><p><span class="keyword">val</span> access : <span class="code type">string -&gt; Unix.access_permission list -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.access</span><br/></p></div><p><br/>
</p><h6 id="6_Operationsonfiledescriptors">Operations on file descriptors <a class="backref" href="#6_Operationsonfiledescriptors">&#182;</a></h6><p><br/>
</p><div class="code" id="VALdup"><p><span class="keyword">val</span> dup : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.dup</span><br/></p></div><div class="code" id="VALdup2"><p><span class="keyword">val</span> dup2 : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.dup2</span><br/></p></div><div class="code" id="VALset_close_on_exec"><p><span class="keyword">val</span> set_close_on_exec : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.set_close_on_exec</span><br/></p></div><div class="code" id="VALclear_close_on_exec"><p><span class="keyword">val</span> clear_close_on_exec : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.clear_close_on_exec</span><br/></p></div><p><br/>
</p><h6 id="6_Directories">Directories <a class="backref" href="#6_Directories">&#182;</a></h6><p><br/>
</p><div class="code" id="VALmkdir"><p><span class="keyword">val</span> mkdir : <span class="code type">string -&gt; Unix.file_perm -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.mkdir</span><br/></p></div><div class="code" id="VALrmdir"><p><span class="keyword">val</span> rmdir : <span class="code type">string -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.rmdir</span><br/></p></div><div class="code" id="VALchdir"><p><span class="keyword">val</span> chdir : <span class="code type">string -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.chdir</span><br/></p></div><div class="code" id="VALchroot"><p><span class="keyword">val</span> chroot : <span class="code type">string -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.chroot</span><br/></p></div><div class="code" id="VALopendir"><p><span class="keyword">val</span> opendir : <span class="code type">string -&gt; Unix.dir_handle <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.opendir</span><br/></p></div><div class="code" id="VALreaddir"><p><span class="keyword">val</span> readdir : <span class="code type">Unix.dir_handle -&gt; string <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.dir</span><br/></p></div><div class="code" id="VALreaddir_n"><p><span class="keyword">val</span> readdir_n : <span class="code type">Unix.dir_handle -&gt; int -&gt; string array <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">readdir_n handle count</span> reads at most <span class="code">count</span> entry from the
given directory. It is more efficient that callling <span class="code">count</span>
times <span class="code">readdir</span>. If the length of the returned array is smaller
than <span class="code">count</span>, this means that the end of the directory has been
reached.<br/></p></div><div class="code" id="VALrewinddir"><p><span class="keyword">val</span> rewinddir : <span class="code type">Unix.dir_handle -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.rewinddir</span><br/></p></div><div class="code" id="VALclosedir"><p><span class="keyword">val</span> closedir : <span class="code type">Unix.dir_handle -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.closedir</span><br/></p></div><div class="code" id="VALfiles_of_directory"><p><span class="keyword">val</span> files_of_directory : <span class="code type">string -&gt; string <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span></span></p></div><div class="info"><p><span class="code">files_of_directory dir</span> returns the stream of all files of
<span class="code">dir</span>.<br/></p></div><p><br/>
</p><h6 id="6_Pipesandredirections">Pipes and redirections <a class="backref" href="#6_Pipesandredirections">&#182;</a></h6><p><br/>
</p><div class="code" id="VALpipe"><p><span class="keyword">val</span> pipe : <span class="code type">unit -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> * <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p><span class="code">pipe ()</span> creates pipe using <span class="code">Unix.pipe</span> and returns two lwt <strong>      file descriptor</strong>s created from unix <strong>file_descriptor</strong><br/></p></div><div class="code" id="VALpipe_in"><p><span class="keyword">val</span> pipe_in : <span class="code type">unit -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> * Unix.file_descr</span></p></div><div class="info"><p><span class="code">pipe_in ()</span> is the same as <span><a href=".././api/Lwt_unix#VALpipe">Lwt_unix.pipe</a></span> but maps only the unix <strong>      file descriptor</strong> for reading into a lwt one. The second is not
put into non-blocking mode. You usually want to use this before
forking to receive data from the child process.<br/></p></div><div class="code" id="VALpipe_out"><p><span class="keyword">val</span> pipe_out : <span class="code type">unit -&gt; Unix.file_descr * <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p><span class="code">pipe_out ()</span> is the inverse of <span><a href=".././api/Lwt_unix#VALpipe_in">Lwt_unix.pipe_in</a></span>. You usually want to
use this before forking to send data to the child process<br/></p></div><div class="code" id="VALmkfifo"><p><span class="keyword">val</span> mkfifo : <span class="code type">string -&gt; Unix.file_perm -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.mkfifo</span><br/></p></div><p><br/>
</p><h6 id="6_Symboliclinks">Symbolic links <a class="backref" href="#6_Symboliclinks">&#182;</a></h6><p><br/>
</p><div class="code" id="VALsymlink"><p><span class="keyword">val</span> symlink : <span class="code type">string -&gt; string -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.symlink</span><br/></p></div><div class="code" id="VALreadlink"><p><span class="keyword">val</span> readlink : <span class="code type">string -&gt; string <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.readlink</span><br/></p></div><p><br/>
</p><h6 id="6_Locking">Locking <a class="backref" href="#6_Locking">&#182;</a></h6><p><br/>
</p><div class="code" id="VALlockf"><p><span class="keyword">val</span> lockf : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.lock_command -&gt; int -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.lockf</span><br/></p></div><p><br/>
</p><h6 id="6_Useridgroupid">User id, group id <a class="backref" href="#6_Useridgroupid">&#182;</a></h6><p><br/>
</p><div class="code" id="VALgetlogin"><p><span class="keyword">val</span> getlogin : <span class="code type">unit -&gt; string <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getlogin</span><br/></p></div><div class="code" id="VALgetpwnam"><p><span class="keyword">val</span> getpwnam : <span class="code type">string -&gt; Unix.passwd_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getpwnam</span><br/></p></div><div class="code" id="VALgetgrnam"><p><span class="keyword">val</span> getgrnam : <span class="code type">string -&gt; Unix.group_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getgrnam</span><br/></p></div><div class="code" id="VALgetpwuid"><p><span class="keyword">val</span> getpwuid : <span class="code type">int -&gt; Unix.passwd_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getpwuid</span><br/></p></div><div class="code" id="VALgetgrgid"><p><span class="keyword">val</span> getgrgid : <span class="code type">int -&gt; Unix.group_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getgrgid</span><br/></p></div><p><br/>
</p><h6 id="6_Signals">Signals <a class="backref" href="#6_Signals">&#182;</a></h6><p><br/>
</p><div class="code" id="TYPEsignal_handler_id"><p><span class="keyword">type</span> signal_handler_id</p></div><div class="info"><p>Id of a signal handler, used to cancel it<br/></p></div><div class="code" id="VALon_signal"><p><span class="keyword">val</span> on_signal : <span class="code type">int -&gt; (int -&gt; unit) -&gt; <span><a href=".././api/Lwt_unix#TYPEsignal_handler_id">signal_handler_id</a></span></span></p></div><div class="info"><p><span class="code">on_signal signum f</span> calls <span class="code">f</span> each time the signal with numnber
<span class="code">signum</span> is received by the process. It returns a signal handler
identifier which can be used to stop monitoring <span class="code">signum</span>.<br/></p></div><div class="code" id="VALdisable_signal_handler"><p><span class="keyword">val</span> disable_signal_handler : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEsignal_handler_id">signal_handler_id</a></span> -&gt; unit</span></p></div><div class="info"><p>Stops receiving this signal<br/></p></div><p><br/>
</p><h6 id="6_Sockets">Sockets <a class="backref" href="#6_Sockets">&#182;</a></h6><p><br/>
</p><div class="code" id="VALsocket"><p><span class="keyword">val</span> socket : <span class="code type">Unix.socket_domain -&gt; Unix.socket_type -&gt; int -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p><span class="code">socket domain type proto</span> is the same as <span class="code">Unix.socket</span> but maps
the result into a lwt <strong>file descriptor</strong><br/></p></div><div class="code" id="VALsocketpair"><p><span class="keyword">val</span> socketpair : <span class="code type"><br/><span class="teletype">   </span>Unix.socket_domain -&gt;<br/><span class="teletype">   </span>  Unix.socket_type -&gt; int -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> * <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.socketpair</span><br/></p></div><div class="code" id="VALbind"><p><span class="keyword">val</span> bind : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.sockaddr -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.bind</span><br/></p></div><div class="code" id="VALlisten"><p><span class="keyword">val</span> listen : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; int -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.listen</span><br/></p></div><div class="code" id="VALaccept"><p><span class="keyword">val</span> accept : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; (<span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> * Unix.sockaddr) <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.accept</span><br/></p></div><div class="code" id="VALaccept_n"><p><span class="keyword">val</span> accept_n : <span class="code type"><br/><span class="teletype">   </span><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt;<br/><span class="teletype">   </span>  int -&gt; ((<span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> * Unix.sockaddr) list * exn option) <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">accept_n fd count</span> accepts up to <span class="code">count</span> connection in one time.<br/>
</p><ul><li> if no connection is available right now, it returns a sleeping
thread
</li></ul><ul><li> if more that 1 and less than <span class="code">count</span> are available, it returns
all of them
</li></ul><ul><li> if more that <span class="code">count</span> are available, it returns the next
<span class="code">count</span> of them
</li></ul><ul><li> if an error happen, it returns the connections that have been
successfully accepted so far and the error
</li></ul><p><span class="code">accept_n</span> has the advantage of improving performances. If you
want a more detailed description, you can have a look at:<br/>
</p><p><a href="http://portal.acm.org/citation.cfm?id=1247435" class="ocsimore_phrasing_link">Acceptable strategies for improving web server performance</a><br/></p></div><div class="code" id="VALconnect"><p><span class="keyword">val</span> connect : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.sockaddr -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.connect</span><br/></p></div><div class="code" id="VALshutdown"><p><span class="keyword">val</span> shutdown : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.shutdown_command -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.shutdown</span><br/></p></div><div class="code" id="VALgetsockname"><p><span class="keyword">val</span> getsockname : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.sockaddr</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getsockname</span><br/></p></div><div class="code" id="VALgetpeername"><p><span class="keyword">val</span> getpeername : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.sockaddr</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getpeername</span><br/></p></div><div class="code" id="VALrecv"><p><span class="keyword">val</span> recv : <span class="code type"><br/><span class="teletype">   </span><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt;<br/><span class="teletype">   </span>  string -&gt; int -&gt; int -&gt; Unix.msg_flag list -&gt; int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.recv</span><br/></p></div><div class="code" id="VALrecvfrom"><p><span class="keyword">val</span> recvfrom : <span class="code type"><br/><span class="teletype">   </span><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt;<br/><span class="teletype">   </span>  string -&gt; int -&gt; int -&gt; Unix.msg_flag list -&gt; (int * Unix.sockaddr) <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.recvfrom</span><br/></p></div><div class="code" id="VALsend"><p><span class="keyword">val</span> send : <span class="code type"><br/><span class="teletype">   </span><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt;<br/><span class="teletype">   </span>  string -&gt; int -&gt; int -&gt; Unix.msg_flag list -&gt; int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.send</span><br/></p></div><div class="code" id="VALsendto"><p><span class="keyword">val</span> sendto : <span class="code type"><br/><span class="teletype">   </span><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt;<br/><span class="teletype">   </span>  string -&gt; int -&gt; int -&gt; Unix.msg_flag list -&gt; Unix.sockaddr -&gt; int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.sendto</span><br/></p></div><div class="code" id="TYPEio_vector"><p><span class="keyword">type</span> io_vector = { 
</p><table class="typetable"><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">iov_buffer : <span class="code type">string</span>;</td></tr><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">iov_offset : <span class="code type">int</span>;</td></tr><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">iov_length : <span class="code type">int</span>;</td></tr></table><p>}</p></div><div class="info"><p>An io-vector. Used by <span><a href=".././api/Lwt_unix#VALrecv_msg">Lwt_unix.recv_msg</a></span> and <span><a href=".././api/Lwt_unix#VALsend_msg">Lwt_unix.send_msg</a></span>.<br/></p></div><div class="code" id="VALio_vector"><p><span class="keyword">val</span> io_vector : <span class="code type">buffer:string -&gt; offset:int -&gt; length:int -&gt; <span><a href=".././api/Lwt_unix#TYPEio_vector">io_vector</a></span></span></p></div><div class="info"><p>Creates an io-vector<br/></p></div><div class="code" id="VALrecv_msg"><p><span class="keyword">val</span> recv_msg : <span class="code type"><br/><span class="teletype">   </span>socket:<span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt;<br/><span class="teletype">   </span>  io_vectors:<span><a href=".././api/Lwt_unix#TYPEio_vector">io_vector</a></span> list -&gt; (int * Unix.file_descr list) <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">recv_msg ~socket ~io_vectors</span> receives data into a list of
io-vectors, plus any file-descriptors that may accompany the
message.<br/></p></div><div class="code" id="VALsend_msg"><p><span class="keyword">val</span> send_msg : <span class="code type"><br/><span class="teletype">   </span>socket:<span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt;<br/><span class="teletype">   </span>  io_vectors:<span><a href=".././api/Lwt_unix#TYPEio_vector">io_vector</a></span> list -&gt; fds:Unix.file_descr list -&gt; int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">send_msg ~socket ~io_vectors ~fds</span> sends data from a list of
io-vectors, accompanied with a list of file-descriptor.<br/></p></div><div class="code" id="TYPEcredentials"><p><span class="keyword">type</span> credentials = { 
</p><table class="typetable"><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">cred_pid : <span class="code type">int</span>;</td></tr><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">cred_uid : <span class="code type">int</span>;</td></tr><tr><td class="lefttop"><span class="teletype">   </span></td><td class="lefttop">cred_gid : <span class="code type">int</span>;</td></tr></table><p>}</p></div><div class="code" id="VALget_credentials"><p><span class="keyword">val</span> get_credentials : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; <span><a href=".././api/Lwt_unix#TYPEcredentials">credentials</a></span></span></p></div><div class="info"><p><span class="code">get_credentials fd</span> returns credential informations from the
given socket.<br/></p></div><p><br/>
</p><div class="h8"><p>Socket options</p></div><p><br/>
</p><div class="code" id="VALgetsockopt"><p><span class="keyword">val</span> getsockopt : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_bool_option -&gt; bool</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getsockopt</span><br/></p></div><div class="code" id="VALsetsockopt"><p><span class="keyword">val</span> setsockopt : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_bool_option -&gt; bool -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.setsockopt</span><br/></p></div><div class="code" id="VALgetsockopt_int"><p><span class="keyword">val</span> getsockopt_int : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_int_option -&gt; int</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getsockopt_int</span><br/></p></div><div class="code" id="VALsetsockopt_int"><p><span class="keyword">val</span> setsockopt_int : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_int_option -&gt; int -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.setsockopt_int</span><br/></p></div><div class="code" id="VALgetsockopt_optint"><p><span class="keyword">val</span> getsockopt_optint : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_optint_option -&gt; int option</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getsockopt_optint</span><br/></p></div><div class="code" id="VALsetsockopt_optint"><p><span class="keyword">val</span> setsockopt_optint : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_optint_option -&gt; int option -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.setsockopt_optint</span><br/></p></div><div class="code" id="VALgetsockopt_float"><p><span class="keyword">val</span> getsockopt_float : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_float_option -&gt; float</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getsockopt_float</span><br/></p></div><div class="code" id="VALsetsockopt_float"><p><span class="keyword">val</span> setsockopt_float : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.socket_float_option -&gt; float -&gt; unit</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.setsockopt_float</span><br/></p></div><div class="code" id="VALgetsockopt_error"><p><span class="keyword">val</span> getsockopt_error : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.error option</span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getsockopt_error</span><br/></p></div><p><br/>
</p><h6 id="6_Hostandprotocoldatabases">Host and protocol databases <a class="backref" href="#6_Hostandprotocoldatabases">&#182;</a></h6><p><br/>
</p><div class="code" id="VALgethostname"><p><span class="keyword">val</span> gethostname : <span class="code type">unit -&gt; string <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.gethostname</span><br/></p></div><div class="code" id="VALgethostbyname"><p><span class="keyword">val</span> gethostbyname : <span class="code type">string -&gt; Unix.host_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.gethostbyname</span><br/></p></div><div class="code" id="VALgethostbyaddr"><p><span class="keyword">val</span> gethostbyaddr : <span class="code type">Unix.inet_addr -&gt; Unix.host_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.gethostbyaddr</span><br/></p></div><div class="code" id="VALgetprotobyname"><p><span class="keyword">val</span> getprotobyname : <span class="code type">string -&gt; Unix.protocol_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getprotobyname</span><br/></p></div><div class="code" id="VALgetprotobynumber"><p><span class="keyword">val</span> getprotobynumber : <span class="code type">int -&gt; Unix.protocol_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getprotobynumber</span><br/></p></div><div class="code" id="VALgetservbyname"><p><span class="keyword">val</span> getservbyname : <span class="code type">string -&gt; string -&gt; Unix.service_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getservbyname</span><br/></p></div><div class="code" id="VALgetservbyport"><p><span class="keyword">val</span> getservbyport : <span class="code type">int -&gt; string -&gt; Unix.service_entry <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getservbyport</span><br/></p></div><div class="code" id="VALgetaddrinfo"><p><span class="keyword">val</span> getaddrinfo : <span class="code type">string -&gt; string -&gt; Unix.getaddrinfo_option list -&gt; Unix.addr_info list <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getaddrinfo</span><br/></p></div><div class="code" id="VALgetnameinfo"><p><span class="keyword">val</span> getnameinfo : <span class="code type">Unix.sockaddr -&gt; Unix.getnameinfo_option list -&gt; Unix.name_info <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.getnameinfo</span><br/></p></div><p><br/>
</p><h6 id="6_Terminalinterface">Terminal interface <a class="backref" href="#6_Terminalinterface">&#182;</a></h6><p><br/>
</p><div class="code" id="VALtcgetattr"><p><span class="keyword">val</span> tcgetattr : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.terminal_io <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.tcgetattr</span><br/></p></div><div class="code" id="VALtcsetattr"><p><span class="keyword">val</span> tcsetattr : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.setattr_when -&gt; Unix.terminal_io -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.tcsetattr</span><br/></p></div><div class="code" id="VALtcsendbreak"><p><span class="keyword">val</span> tcsendbreak : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; int -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.tcsendbreak</span><br/></p></div><div class="code" id="VALtcdrain"><p><span class="keyword">val</span> tcdrain : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.tcdrain</span><br/></p></div><div class="code" id="VALtcflush"><p><span class="keyword">val</span> tcflush : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.flush_queue -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.tcflush</span><br/></p></div><div class="code" id="VALtcflow"><p><span class="keyword">val</span> tcflow : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; Unix.flow_action -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Wrapper for <span class="code">Unix.tcflow</span><br/></p></div><p><br/>
</p><h6 id="6_Lowlevelinteraction">Low-level interaction <a class="backref" href="#6_Lowlevelinteraction">&#182;</a></h6><p><br/>
</p><div class="code" id="EXCEPTIONRetry"><p><span class="keyword">exception</span> Retry</p></div><div class="info"><p>If an action raises <span><a href=".././api/Lwt_unix#EXCEPTIONRetry">Lwt_unix.Retry</a></span>, it will be requeued until the <strong>      file descriptor</strong> becomes readable/writable again.<br/></p></div><div class="code" id="EXCEPTIONRetry_read"><p><span class="keyword">exception</span> Retry_read</p></div><div class="info"><p>If an action raises <span><a href=".././api/Lwt_unix#EXCEPTIONRetry_read">Lwt_unix.Retry_read</a></span>, it will be requeued until the
      <strong>file descriptor</strong> becomes readable.<br/></p></div><div class="code" id="EXCEPTIONRetry_write"><p><span class="keyword">exception</span> Retry_write</p></div><div class="info"><p>If an action raises <span><a href=".././api/Lwt_unix#EXCEPTIONRetry_read">Lwt_unix.Retry_read</a></span>, it will be requeued until the
      <strong>file descriptor</strong> becomes writables.<br/></p></div><div class="code" id="TYPEio_event"><p><span class="keyword">type</span> io_event = 
</p><table class="typetable"><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Read</span></td></tr><tr><td class="lefttop"><span class="keyword"><span class="teletype">|</span></span></td><td class="lefttop"><span class="constructor">Write</span></td></tr></table></div><div class="code" id="VALwrap_syscall"><p><span class="keyword">val</span> wrap_syscall : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEio_event">io_event</a></span> -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; (unit -&gt; 'a) -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">wrap_syscall set fd action</span> wrap an action on a <strong>file
descriptor</strong>. It tries to execture action, and if it can not be
performed immediately without blocking, it is registered for
latter.<br/>
</p><p>In the latter case, if the thread is canceled, <span class="code">action</span> is
removed from <span class="code">set</span>.<br/></p></div><div class="code" id="VALcheck_descriptor"><p><span class="keyword">val</span> check_descriptor : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; unit</span></p></div><div class="info"><p><span class="code">check_descriptor fd</span> raise an exception if <span class="code">fd</span> is not in the
state <span class="code">Open</span><br/></p></div><div class="code" id="VALregister_action"><p><span class="keyword">val</span> register_action : <span class="code type"><span><a href=".././api/Lwt_unix#TYPEio_event">io_event</a></span> -&gt; <span><a href=".././api/Lwt_unix#TYPEfile_descr">file_descr</a></span> -&gt; (unit -&gt; 'a) -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">register_action set fd action</span> registers <span class="code">action</span> on <span class="code">fd</span>. When
<span class="code">fd</span> becomes <span class="code">readable</span>/<span class="code">writable</span> <span class="code">action</span> is called.<br/>
</p><p>Note:<br/>
</p><ul><li> you must call <span class="code">check_descriptor fd</span> before calling
<span class="code">register_action</span>
</li></ul><ul><li> you should prefer using <span><a href=".././api/Lwt_unix#VALwrap_syscall">Lwt_unix.wrap_syscall</a></span>
</li></ul><p><br/></p></div><div class="code" id="TYPEjob"><p><span class="keyword">type</span> <span class="code type">'a</span> job</p></div><div class="info"><p>Type of jobs that run:<br/>
</p><ul><li> on another thread if the current async method is <span class="code">Async_thread</span>
</li><li> on the main thread if the current async method is <span class="code">Async_none</span>.
</li></ul><p><br/></p></div><div class="code" id="VALexecute_job"><p><span class="keyword">val</span> execute_job : <span class="code type"><br/><span class="teletype">   </span>?async_method:<span><a href=".././api/Lwt_unix#TYPEasync_method">async_method</a></span> -&gt;<br/><span class="teletype">   </span>  job:'a <span><a href=".././api/Lwt_unix#TYPEjob">job</a></span> -&gt;<br/><span class="teletype">   </span>  result:('a <span><a href=".././api/Lwt_unix#TYPEjob">job</a></span> -&gt; 'b) -&gt; free:('a <span><a href=".././api/Lwt_unix#TYPEjob">job</a></span> -&gt; unit) -&gt; 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">execute_job ?async_method ~job ~get ~free</span> starts
<span class="code">job</span> and wait for its termination.<br/>
</p><p><span class="code">async_method</span> is how the job will be executed. It defaults to
the async method of the current thread. <span class="code">result</span> is used to get
the result of the job, and <span class="code">free</span> to free its associated
resources.<br/></p></div><p><br/>
</p><h6 id="6_Notifications">Notifications <a class="backref" href="#6_Notifications">&#182;</a></h6><p><br/>
<br/>
Lwt internally use a pipe to send notification to the main
thread. The following functions allow to use this pipe.<br/>
</p><div class="code" id="VALmake_notification"><p><span class="keyword">val</span> make_notification : <span class="code type">?once:bool -&gt; (unit -&gt; unit) -&gt; int</span></p></div><div class="info"><p><span class="code">new_notifier ?once f</span> registers a new notifier. It returns the
id of the notifier. Each time a notification with this id is
received, <span class="code">f</span> is called.<br/>
</p><p>if <span class="code">once</span> is specified, then the notification is stopped after
the first time it is received. It defaults to <span class="code">false</span>.<br/></p></div><div class="code" id="VALsend_notification"><p><span class="keyword">val</span> send_notification : <span class="code type">int -&gt; unit</span></p></div><div class="info"><p><span class="code">send_notification id</span> sends a notification.<br/>
</p><p>This function is thread-safe.<br/></p></div><div class="code" id="VALstop_notification"><p><span class="keyword">val</span> stop_notification : <span class="code type">int -&gt; unit</span></p></div><div class="info"><p>Stop the given notification. Note that you should not reuse the
id after the notification has been stopped, the result is
unspecified if you do so.<br/></p></div><div class="code" id="VALset_notification"><p><span class="keyword">val</span> set_notification : <span class="code type">int -&gt; (unit -&gt; unit) -&gt; unit</span></p></div><div class="info"><p><span class="code">set_notification id f</span> replace the function associated to the
notification by <span class="code">f</span>. It raises <span class="code">Not_found</span> if the given
notification is not found.<br/></p></div><p><br/>
</p><h6 id="6_Systemthreadspool">System threads pool <a class="backref" href="#6_Systemthreadspool">&#182;</a></h6><p><br/>
<br/>
If the program is using the async method <span class="code">Async_detach</span> or
<span class="code">Async_switch</span>, Lwt will launch system threads to execute
blocking system calls asynchronously.<br/>
</p><div class="code" id="VALpool_size"><p><span class="keyword">val</span> pool_size : <span class="code type">unit -&gt; int</span></p></div><div class="info"><p>Maximum number of system threads that can be started. If this
limit is reached, jobs will be executed synchronously.<br/></p></div><div class="code" id="VALset_pool_size"><p><span class="keyword">val</span> set_pool_size : <span class="code type">int -&gt; unit</span></p></div><div class="info"><p>Change the size of the pool.<br/></p></div><div class="code" id="VALthread_count"><p><span class="keyword">val</span> thread_count : <span class="code type">unit -&gt; int</span></p></div><div class="info"><p>The number of system threads running (excluding this one).<br/></p></div><div class="code" id="VALthread_waiting_count"><p><span class="keyword">val</span> thread_waiting_count : <span class="code type">unit -&gt; int</span></p></div><div class="info"><p>The number threads waiting for a job.<br/></p></div><p><br/>
</p><h6 id="6_CPUs">CPUs <a class="backref" href="#6_CPUs">&#182;</a></h6><p><br/>
</p><div class="code" id="VALget_cpu"><p><span class="keyword">val</span> get_cpu : <span class="code type">unit -&gt; int</span></p></div><div class="info"><p><span class="code">get_cpu ()</span> returns the number of the CPU the current thread is
running on.<br/></p></div><div class="code" id="VALget_affinity"><p><span class="keyword">val</span> get_affinity : <span class="code type">?pid:int -&gt; unit -&gt; int list</span></p></div><div class="info"><p><span class="code">get_affinity ?pid ()</span> returns the list of CPUs the process with
pid <span class="code">pid</span> is allowed to run on. If <span class="code">pid</span> is not specified then
the affinity of the current process is returned.<br/></p></div><div class="code" id="VALset_affinity"><p><span class="keyword">val</span> set_affinity : <span class="code type">?pid:int -&gt; int list -&gt; unit</span></p></div><div class="info"><p><span class="code">set_affinity ?pid cpus</span> sets the list of CPUs the given process
is allowed to run on.<br/></p></div></article></div></div></body></html>
