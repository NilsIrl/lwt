<html><head><title>Module Lwt_util </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="text/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="Lwt_util lwt"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Lwt</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p class="mainmenu-current"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../deriving/" class="ocsimore_phrasing_link">deriving</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1>Ocsigen - Reference manual</h1><h2>Ocsigen</h2><h3>Persistent data, writing in the logs, configuration file extension, Xhtml pretty printing</h3><h4><a href=".././api/Ocsipersist" class="ocsimore_phrasing_link">Ocsipersist</a></h4><h4><a href=".././api/Ocsigen_messages" class="ocsimore_phrasing_link">Ocsigen_messages</a></h4><h4><a href=".././api/Ocsigen_parseconfig" class="ocsimore_phrasing_link">Ocsigen_parseconfig</a></h4><h4><a href=".././api/Simplexmlparser" class="ocsimore_phrasing_link">Simplexmlparser</a></h4><h4><a href=".././api/Xhtmlpretty" class="ocsimore_phrasing_link">Xhtmlpretty</a></h4><h4><a href=".././api/Xhtmlcompact" class="ocsimore_phrasing_link">Xhtmlcompact</a></h4><h3>Extending Ocsigen</h3><h4><a href=".././api/Ocsigen_extensions" class="ocsimore_phrasing_link">Ocsigen_extensions</a></h4><h4><a href=".././api/Ocsigen_headers" class="ocsimore_phrasing_link">Ocsigen_headers</a></h4><h4><a href=".././api/Ocsigen_senders" class="ocsimore_phrasing_link">Ocsigen_senders</a></h4><h4><a href=".././api/Ocsigen_http_frame" class="ocsimore_phrasing_link">Ocsigen_http_frame</a></h4><h4><a href=".././api/Ocsigen_http_client" class="ocsimore_phrasing_link">Ocsigen_http_client</a></h4><h4><a href=".././api/Ocsigen_http_com" class="ocsimore_phrasing_link">Ocsigen_http_com</a></h4><h4><a href=".././api/Authbasic" class="ocsimore_phrasing_link">Authbasic</a></h4><h2>Lwt</h2><h3><a href=".././api/Lwt" class="ocsimore_phrasing_link">Lwt</a></h3><h3><a href=".././api/Lwt_unix" class="ocsimore_phrasing_link">Lwt_unix</a></h3><h3><a href=".././api/Lwt_chan" class="ocsimore_phrasing_link">Lwt_chan</a></h3><h3><a href=".././api/Lwt_ssl" class="ocsimore_phrasing_link">Lwt_ssl</a></h3><h3><a href=".././api/Lwt_util" class="ocsimore_phrasing_link">Lwt_util</a></h3><h3><a href=".././api/Lwt_lib" class="ocsimore_phrasing_link">Lwt_lib</a></h3><h3><a href=".././api/Lwt_timeout" class="ocsimore_phrasing_link">Lwt_timeout</a></h3><h3><a href=".././api/Lwt_preemptive" class="ocsimore_phrasing_link">Lwt_preemptive</a></h3><h2>Eliom</h2><h3>Main modules</h3><h4><a href=".././api/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h4><h4><a href=".././api/Eliom_parameters" class="ocsimore_phrasing_link">Eliom_parameters</a></h4><h4><a href=".././api/Eliom_sessions" class="ocsimore_phrasing_link">Eliom_sessions</a></h4><h4><a href=".././api/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h4><h3>Generating pages with OcamlDuce</h3><h4><a href=".././api/Eliom_duce" class="ocsimore_phrasing_link">Eliom_duce</a></h4><h4><a href=".././api/Xhtmltypes_duce" class="ocsimore_phrasing_link">Xhtmltypes_duce</a></h4><h4><a href=".././api/Eliom_duce_tools" class="ocsimore_phrasing_link">Eliom_duce_tools</a></h4><h3>Generating pages typed with polymorphic variants</h3><h4><a href=".././api/Eliom_predefmod.Xhtml" class="ocsimore_phrasing_link">Eliom_predefmod.Xhtml</a></h4><h4><a href=".././api/XHTML" class="ocsimore_phrasing_link">XHTML</a></h4><h4><a href=".././api/Xhtmltypes" class="ocsimore_phrasing_link">Xhtmltypes</a></h4><h4><a href=".././api/Eliom_tools" class="ocsimore_phrasing_link">Eliom_tools</a></h4><h3>Other kinds of pages</h3><h4><a href=".././api/Eliom_predefmod" class="ocsimore_phrasing_link">Eliom_predefmod</a></h4><h3>Creating your own kinds of pages</h3><h4><a href=".././api/Eliom_mkforms" class="ocsimore_phrasing_link">Eliom_mkforms</a></h4><h4><a href=".././api/Eliom_mkreg" class="ocsimore_phrasing_link">Eliom_mkreg</a></h4><h4><a href=".././api/Xhtmlpretty" class="ocsimore_phrasing_link">Xhtmlpretty</a></h4></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../1.0.0/api/Lwt_util" selected="selected">1.0.0</option><option value=".././../1.1.0/api/Lwt_util">1.1.0</option><option value=".././../2.0.0/api/Lwt_util">2.0.0</option><option value=".././../2.1.0/api/Lwt_util">2.1.0</option><option value=".././../2.1.1/api/Lwt_util">2.1.1</option><option value=".././../2.2.0/api/Lwt_util">2.2.0</option><option value=".././../2.2.1/api/Lwt_util">2.2.1</option><option value=".././../2.3.0/api/Lwt_util">2.3.0</option><option value=".././../2.3.1/api/Lwt_util">2.3.1</option><option value=".././../2.3.2/api/Lwt_util">2.3.2</option><option value=".././../2.4.0/api/Lwt_util">2.4.0</option><option value=".././../2.4.1/api/Lwt_util">2.4.1</option><option value=".././../2.4.2/api/Lwt_util">2.4.2</option><option value=".././../2.4.3/api/Lwt_util">2.4.3</option><option value=".././../2.4.7/api/Lwt_util">2.4.7</option><option value=".././../2.4.8/api/Lwt_util">2.4.8</option><option value=".././../2.5.0/api/Lwt_util">2.5.0</option><option value=".././../2.5.1/api/Lwt_util">2.5.1</option><option value=".././../2.5.2/api/Lwt_util">2.5.2</option><option value=".././../2.6.0/api/Lwt_util">2.6.0</option><option value=".././../2.7.0/api/Lwt_util">2.7.0</option><option value=".././../2.7.1/api/Lwt_util">2.7.1</option><option value=".././../3.0.0/api/Lwt_util">3.0.0</option><option value=".././../3.1.0/api/Lwt_util">3.1.0</option><option value=".././../3.2.1/api/Lwt_util">3.2.1</option><option value=".././../3.3.0/api/Lwt_util">3.3.0</option><option value=".././../4.0.0/api/Lwt_util">4.0.0</option><option value=".././../4.0.1/api/Lwt_util">4.0.1</option><option value=".././../4.1.0/api/Lwt_util">4.1.0</option><option value=".././../4.2.0/api/Lwt_util">4.2.0</option><option value=".././../4.2.1/api/Lwt_util">4.2.1</option><option value=".././../4.3.0/api/Lwt_util">4.3.0</option><option value=".././../4.3.1/api/Lwt_util">4.3.1</option><option value=".././../4.4.0/api/Lwt_util">4.4.0</option><option value=".././../4.5.0/api/Lwt_util">4.5.0</option><option value=".././../5.0.0/api/Lwt_util">5.0.0</option><option value=".././../5.0.1/api/Lwt_util">5.0.1</option><option value=".././../5.1.0/api/Lwt_util">5.1.0</option><option value=".././../5.1.1/api/Lwt_util">5.1.1</option><option value=".././../5.1.2/api/Lwt_util">5.1.2</option><option value=".././../5.2.0/api/Lwt_util">5.2.0</option><option value=".././../5.3.0/api/Lwt_util">5.3.0</option><option value=".././../dev/api/Lwt_util">dev</option></select><nav class="how-doctree"><h1>Ocsigen - Reference manual</h1><h2>Ocsigen</h2><h3>Persistent data, writing in the logs, configuration file extension, Xhtml pretty printing</h3><h4><a href=".././api/Ocsipersist" class="ocsimore_phrasing_link">Ocsipersist</a></h4><h4><a href=".././api/Ocsigen_messages" class="ocsimore_phrasing_link">Ocsigen_messages</a></h4><h4><a href=".././api/Ocsigen_parseconfig" class="ocsimore_phrasing_link">Ocsigen_parseconfig</a></h4><h4><a href=".././api/Simplexmlparser" class="ocsimore_phrasing_link">Simplexmlparser</a></h4><h4><a href=".././api/Xhtmlpretty" class="ocsimore_phrasing_link">Xhtmlpretty</a></h4><h4><a href=".././api/Xhtmlcompact" class="ocsimore_phrasing_link">Xhtmlcompact</a></h4><h3>Extending Ocsigen</h3><h4><a href=".././api/Ocsigen_extensions" class="ocsimore_phrasing_link">Ocsigen_extensions</a></h4><h4><a href=".././api/Ocsigen_headers" class="ocsimore_phrasing_link">Ocsigen_headers</a></h4><h4><a href=".././api/Ocsigen_senders" class="ocsimore_phrasing_link">Ocsigen_senders</a></h4><h4><a href=".././api/Ocsigen_http_frame" class="ocsimore_phrasing_link">Ocsigen_http_frame</a></h4><h4><a href=".././api/Ocsigen_http_client" class="ocsimore_phrasing_link">Ocsigen_http_client</a></h4><h4><a href=".././api/Ocsigen_http_com" class="ocsimore_phrasing_link">Ocsigen_http_com</a></h4><h4><a href=".././api/Authbasic" class="ocsimore_phrasing_link">Authbasic</a></h4><h2>Lwt</h2><h3><a href=".././api/Lwt" class="ocsimore_phrasing_link">Lwt</a></h3><h3><a href=".././api/Lwt_unix" class="ocsimore_phrasing_link">Lwt_unix</a></h3><h3><a href=".././api/Lwt_chan" class="ocsimore_phrasing_link">Lwt_chan</a></h3><h3><a href=".././api/Lwt_ssl" class="ocsimore_phrasing_link">Lwt_ssl</a></h3><h3><a href=".././api/Lwt_util" class="ocsimore_phrasing_link">Lwt_util</a></h3><h3><a href=".././api/Lwt_lib" class="ocsimore_phrasing_link">Lwt_lib</a></h3><h3><a href=".././api/Lwt_timeout" class="ocsimore_phrasing_link">Lwt_timeout</a></h3><h3><a href=".././api/Lwt_preemptive" class="ocsimore_phrasing_link">Lwt_preemptive</a></h3><h2>Eliom</h2><h3>Main modules</h3><h4><a href=".././api/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h4><h4><a href=".././api/Eliom_parameters" class="ocsimore_phrasing_link">Eliom_parameters</a></h4><h4><a href=".././api/Eliom_sessions" class="ocsimore_phrasing_link">Eliom_sessions</a></h4><h4><a href=".././api/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h4><h3>Generating pages with OcamlDuce</h3><h4><a href=".././api/Eliom_duce" class="ocsimore_phrasing_link">Eliom_duce</a></h4><h4><a href=".././api/Xhtmltypes_duce" class="ocsimore_phrasing_link">Xhtmltypes_duce</a></h4><h4><a href=".././api/Eliom_duce_tools" class="ocsimore_phrasing_link">Eliom_duce_tools</a></h4><h3>Generating pages typed with polymorphic variants</h3><h4><a href=".././api/Eliom_predefmod.Xhtml" class="ocsimore_phrasing_link">Eliom_predefmod.Xhtml</a></h4><h4><a href=".././api/XHTML" class="ocsimore_phrasing_link">XHTML</a></h4><h4><a href=".././api/Xhtmltypes" class="ocsimore_phrasing_link">Xhtmltypes</a></h4><h4><a href=".././api/Eliom_tools" class="ocsimore_phrasing_link">Eliom_tools</a></h4><h3>Other kinds of pages</h3><h4><a href=".././api/Eliom_predefmod" class="ocsimore_phrasing_link">Eliom_predefmod</a></h4><h3>Creating your own kinds of pages</h3><h4><a href=".././api/Eliom_mkforms" class="ocsimore_phrasing_link">Eliom_mkforms</a></h4><h4><a href=".././api/Eliom_mkreg" class="ocsimore_phrasing_link">Eliom_mkreg</a></h4><h4><a href=".././api/Xhtmlpretty" class="ocsimore_phrasing_link">Xhtmlpretty</a></h4></nav></nav><article class="rightcol"><h1>Module <span><a href=".././api/Lwt_util">Lwt_util</a></span> </h1><div class="code"><p><span class="keyword">module</span> Lwt_util: <span class="code">sig</span><span><a href=".././api/Lwt_util">..</a></span><span class="code">end</span></p></div><h2 id="2_Concurrency">Concurrency <a class="backref" href="#2_Concurrency">&#182;</a></h2><p><br/>
</p><hr/><div class="code" id="VALjoin"><p><span class="keyword">val</span> join : <span class="code type">unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span> list -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">join l</span> wait for all threads in <span class="code">l</span> to terminate.
If fails if one of the threads fail.<br/></p></div><p><br/>
</p><h2 id="2_Listsiterators">Lists iterators <a class="backref" href="#2_Listsiterators">&#182;</a></h2><p><br/>
</p><div class="code" id="VALiter"><p><span class="keyword">val</span> iter : <span class="code type">('a -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a list -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">iter f l</span> start a thread for each element in <span class="code">l</span>.  The threads
are started according to the list order, but then can run
concurrently.  It terminates when all the threads are
terminated, if all threads are successful.  It fails if any of
the threads fail.<br/></p></div><div class="code" id="VALiter_serial"><p><span class="keyword">val</span> iter_serial : <span class="code type">('a -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a list -&gt; unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Similar to <span class="code">iter</span> but wait for one thread to terminate before
starting the next one.<br/></p></div><div class="code" id="VALmap"><p><span class="keyword">val</span> map : <span class="code type">('a -&gt; 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a list -&gt; 'b list <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">map f l</span> apply <span class="code">f</span> to each element in <span class="code">l</span> and collect the
results of the threads thus created.  The threads are started
according to the list order, but then can run concurrently.
<span class="code">map f l</span> fails if any of the threads fail.<br/></p></div><div class="code" id="VALmap_with_waiting_action"><p><span class="keyword">val</span> map_with_waiting_action : <span class="code type">('a -&gt; 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; ('a -&gt; unit) -&gt; 'a list -&gt; 'b list <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">map_with_waiting_action f wa l</span> apply <span class="code">f</span> to each element
in <span class="code">l</span> and collect the results of the threads thus created.
The threads are started according to the list order, but
then can run concurrently.  The difference with <span class="code">map f l</span> is
that function wa will be called on the element that the
function is waiting for its termination.<br/></p></div><div class="code" id="VALmap_serial"><p><span class="keyword">val</span> map_serial : <span class="code type">('a -&gt; 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a list -&gt; 'b list <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Similar to <span class="code">map</span> but wait for one thread to terminate before
starting the next one.<br/></p></div><div class="code" id="VALfold_left"><p><span class="keyword">val</span> fold_left : <span class="code type">('a -&gt; 'b -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a -&gt; 'b list -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p>Similar to <span class="code">List.fold_left</span>.<br/></p></div><p><br/>
</p><h2 id="2_Regions">Regions <a class="backref" href="#2_Regions">&#182;</a></h2><p><br/>
</p><div class="code" id="TYPEregion"><p><span class="keyword">type</span> region</p></div><div class="code" id="VALmake_region"><p><span class="keyword">val</span> make_region : <span class="code type">int -&gt; <span><a href=".././api/Lwt_util#TYPEregion">region</a></span></span></p></div><div class="info"><p><span class="code">make_region sz</span> create a region of size <span class="code">sz</span>.<br/></p></div><div class="code" id="VALresize_region"><p><span class="keyword">val</span> resize_region : <span class="code type"><span><a href=".././api/Lwt_util#TYPEregion">region</a></span> -&gt; int -&gt; unit</span></p></div><div class="info"><p><span class="code">resize_region reg sz</span> resize the region <span class="code">reg</span> to size <span class="code">sz</span>.<br/></p></div><div class="code" id="VALrun_in_region"><p><span class="keyword">val</span> run_in_region : <span class="code type"><span><a href=".././api/Lwt_util#TYPEregion">region</a></span> -&gt; int -&gt; (unit -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span>) -&gt; 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></p></div><div class="info"><p><span class="code">run_in_region reg size f</span> execute the thread produced by the
function <span class="code">f</span> in the region <span class="code">reg</span>. The thread is not started
before some room is available in the region.<br/></p></div></article></div></div></body></html>
