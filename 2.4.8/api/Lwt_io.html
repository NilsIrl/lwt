<html><head><title>Module Lwt_io </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="text/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="Lwt_io lwt"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Lwt</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p class="mainmenu-current"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../deriving/" class="ocsimore_phrasing_link">deriving</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1> Lwt</h1><h2><a href=".././manual/manual" class="ocsimore_phrasing_link">Overview</a></h2><h1>Lwt - API Reference</h1><h2>Core library</h2><h3><a href=".././api/Lwt" class="ocsimore_phrasing_link">Lwt</a></h3><h3><a href=".././api/Lwt_condition" class="ocsimore_phrasing_link">Lwt_condition</a></h3><h3><a href=".././api/Lwt_list" class="ocsimore_phrasing_link">Lwt_list</a></h3><h3><a href=".././api/Lwt_mutex" class="ocsimore_phrasing_link">Lwt_mutex</a></h3><h3><a href=".././api/Lwt_mvar" class="ocsimore_phrasing_link">Lwt_mvar</a></h3><h3><a href=".././api/Lwt_pool" class="ocsimore_phrasing_link">Lwt_pool</a></h3><h3><a href=".././api/Lwt_sequence" class="ocsimore_phrasing_link">Lwt_sequence</a></h3><h3><a href=".././api/Lwt_pqueue" class="ocsimore_phrasing_link">Lwt_pqueue</a></h3><h3><a href=".././api/Lwt_stream" class="ocsimore_phrasing_link">Lwt_stream</a></h3><h3><a href=".././api/Lwt_switch" class="ocsimore_phrasing_link">Lwt_switch</a></h3><h2>Logger</h2><h3><a href=".././api/Lwt_log_core" class="ocsimore_phrasing_link">Lwt_log_core</a></h3><h2>Unix bindings</h2><h3><a href=".././api/Lwt_daemon" class="ocsimore_phrasing_link">Lwt_daemon</a></h3><h3><a href=".././api/Lwt_gc" class="ocsimore_phrasing_link">Lwt_gc</a></h3><h3><a href=".././api/Lwt_io" class="ocsimore_phrasing_link">Lwt_io</a></h3><h3><a href=".././api/Lwt_log" class="ocsimore_phrasing_link">Lwt_log</a></h3><h3><a href=".././api/Lwt_main" class="ocsimore_phrasing_link">Lwt_main</a></h3><h3><a href=".././api/Lwt_engine" class="ocsimore_phrasing_link">Lwt_engine</a></h3><h3><a href=".././api/Lwt_process" class="ocsimore_phrasing_link">Lwt_process</a></h3><h3><a href=".././api/Lwt_throttle" class="ocsimore_phrasing_link">Lwt_throttle</a></h3><h3><a href=".././api/Lwt_timeout" class="ocsimore_phrasing_link">Lwt_timeout</a></h3><h3><a href=".././api/Lwt_unix" class="ocsimore_phrasing_link">Lwt_unix</a></h3><h3><a href=".././api/Lwt_bytes" class="ocsimore_phrasing_link">Lwt_bytes</a></h3><h3><a href=".././api/Lwt_sys" class="ocsimore_phrasing_link">Lwt_sys</a></h3><h2>Reactive programming helpers</h2><h3><a href=".././api/Lwt_react" class="ocsimore_phrasing_link">Lwt_react</a></h3><h2>caml4 syntax extensions</h2><h3><a href=".././api/Pa_lwt" class="ocsimore_phrasing_link">Pa_lwt</a></h3><h3><a href=".././api/Pa_lwt_log" class="ocsimore_phrasing_link">Pa_lwt_log</a></h3><h2>ppx syntax extension</h2><h3><a href=".././api/Ppx_lwt" class="ocsimore_phrasing_link">Ppx_lwt</a></h3><h2>Miscellaneous</h2><h3><a href=".././api/Lwt_glib" class="ocsimore_phrasing_link">Lwt_glib</a></h3><h3><a href=".././api/Lwt_preemptive" class="ocsimore_phrasing_link">Lwt_preemptive</a></h3><h3><a href=".././api/Lwt_ssl" class="ocsimore_phrasing_link">Lwt_ssl</a></h3><h2>Index</h2><h3> <span><a href=".././api/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/index_attributes">Index of class attributes</a></span></h3><h3> <span><a href=".././api/index_methods">Index of class methods</a></span></h3><h3> <span><a href=".././api/index_classes">Index of classes</a></span></h3><h3> <span><a href=".././api/index_class_types">Index of class types</a></span></h3><h3> <span><a href=".././api/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/index_module_types">Index of module types</a></span></h3></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../1.0.0/api/Lwt_io">1.0.0</option><option value=".././../1.1.0/api/Lwt_io">1.1.0</option><option value=".././../2.0.0/api/Lwt_io">2.0.0</option><option value=".././../2.1.0/api/Lwt_io">2.1.0</option><option value=".././../2.1.1/api/Lwt_io">2.1.1</option><option value=".././../2.2.0/api/Lwt_io">2.2.0</option><option value=".././../2.2.1/api/Lwt_io">2.2.1</option><option value=".././../2.3.0/api/Lwt_io">2.3.0</option><option value=".././../2.3.1/api/Lwt_io">2.3.1</option><option value=".././../2.3.2/api/Lwt_io">2.3.2</option><option value=".././../2.4.0/api/Lwt_io">2.4.0</option><option value=".././../2.4.1/api/Lwt_io">2.4.1</option><option value=".././../2.4.2/api/Lwt_io">2.4.2</option><option value=".././../2.4.3/api/Lwt_io">2.4.3</option><option value=".././../2.4.7/api/Lwt_io">2.4.7</option><option value=".././../2.4.8/api/Lwt_io" selected="selected">2.4.8</option><option value=".././../2.5.0/api/Lwt_io">2.5.0</option><option value=".././../2.5.1/api/Lwt_io">2.5.1</option><option value=".././../2.5.2/api/Lwt_io">2.5.2</option><option value=".././../2.6.0/api/Lwt_io">2.6.0</option><option value=".././../2.7.0/api/Lwt_io">2.7.0</option><option value=".././../2.7.1/api/Lwt_io">2.7.1</option><option value=".././../3.0.0/api/Lwt_io">3.0.0</option><option value=".././../3.1.0/api/Lwt_io">3.1.0</option><option value=".././../3.2.1/api/Lwt_io">3.2.1</option><option value=".././../3.3.0/api/Lwt_io">3.3.0</option><option value=".././../4.0.0/api/Lwt_io">4.0.0</option><option value=".././../4.0.1/api/Lwt_io">4.0.1</option><option value=".././../4.1.0/api/Lwt_io">4.1.0</option><option value=".././../4.2.0/api/Lwt_io">4.2.0</option><option value=".././../4.2.1/api/Lwt_io">4.2.1</option><option value=".././../4.3.0/api/Lwt_io">4.3.0</option><option value=".././../4.3.1/api/Lwt_io">4.3.1</option><option value=".././../4.4.0/api/Lwt_io">4.4.0</option><option value=".././../4.5.0/api/Lwt_io">4.5.0</option><option value=".././../5.0.0/api/Lwt_io">5.0.0</option><option value=".././../5.0.1/api/Lwt_io">5.0.1</option><option value=".././../5.1.0/api/Lwt_io">5.1.0</option><option value=".././../5.1.1/api/Lwt_io">5.1.1</option><option value=".././../5.1.2/api/Lwt_io">5.1.2</option><option value=".././../5.2.0/api/Lwt_io">5.2.0</option><option value=".././../5.3.0/api/Lwt_io">5.3.0</option><option value=".././../5.4.0/api/Lwt_io">5.4.0</option><option value=".././../5.4.1/api/Lwt_io">5.4.1</option><option value=".././../5.4.2/api/Lwt_io">5.4.2</option><option value=".././../5.5.0/api/Lwt_io">5.5.0</option><option value=".././../dev/api/Lwt_io">dev</option></select><nav class="how-doctree"><h1> Lwt</h1><h2><a href=".././manual/manual" class="ocsimore_phrasing_link">Overview</a></h2><h1>Lwt - API Reference</h1><h2>Core library</h2><h3><a href=".././api/Lwt" class="ocsimore_phrasing_link">Lwt</a></h3><h3><a href=".././api/Lwt_condition" class="ocsimore_phrasing_link">Lwt_condition</a></h3><h3><a href=".././api/Lwt_list" class="ocsimore_phrasing_link">Lwt_list</a></h3><h3><a href=".././api/Lwt_mutex" class="ocsimore_phrasing_link">Lwt_mutex</a></h3><h3><a href=".././api/Lwt_mvar" class="ocsimore_phrasing_link">Lwt_mvar</a></h3><h3><a href=".././api/Lwt_pool" class="ocsimore_phrasing_link">Lwt_pool</a></h3><h3><a href=".././api/Lwt_sequence" class="ocsimore_phrasing_link">Lwt_sequence</a></h3><h3><a href=".././api/Lwt_pqueue" class="ocsimore_phrasing_link">Lwt_pqueue</a></h3><h3><a href=".././api/Lwt_stream" class="ocsimore_phrasing_link">Lwt_stream</a></h3><h3><a href=".././api/Lwt_switch" class="ocsimore_phrasing_link">Lwt_switch</a></h3><h2>Logger</h2><h3><a href=".././api/Lwt_log_core" class="ocsimore_phrasing_link">Lwt_log_core</a></h3><h2>Unix bindings</h2><h3><a href=".././api/Lwt_daemon" class="ocsimore_phrasing_link">Lwt_daemon</a></h3><h3><a href=".././api/Lwt_gc" class="ocsimore_phrasing_link">Lwt_gc</a></h3><h3><a href=".././api/Lwt_io" class="ocsimore_phrasing_link">Lwt_io</a></h3><h3><a href=".././api/Lwt_log" class="ocsimore_phrasing_link">Lwt_log</a></h3><h3><a href=".././api/Lwt_main" class="ocsimore_phrasing_link">Lwt_main</a></h3><h3><a href=".././api/Lwt_engine" class="ocsimore_phrasing_link">Lwt_engine</a></h3><h3><a href=".././api/Lwt_process" class="ocsimore_phrasing_link">Lwt_process</a></h3><h3><a href=".././api/Lwt_throttle" class="ocsimore_phrasing_link">Lwt_throttle</a></h3><h3><a href=".././api/Lwt_timeout" class="ocsimore_phrasing_link">Lwt_timeout</a></h3><h3><a href=".././api/Lwt_unix" class="ocsimore_phrasing_link">Lwt_unix</a></h3><h3><a href=".././api/Lwt_bytes" class="ocsimore_phrasing_link">Lwt_bytes</a></h3><h3><a href=".././api/Lwt_sys" class="ocsimore_phrasing_link">Lwt_sys</a></h3><h2>Reactive programming helpers</h2><h3><a href=".././api/Lwt_react" class="ocsimore_phrasing_link">Lwt_react</a></h3><h2>caml4 syntax extensions</h2><h3><a href=".././api/Pa_lwt" class="ocsimore_phrasing_link">Pa_lwt</a></h3><h3><a href=".././api/Pa_lwt_log" class="ocsimore_phrasing_link">Pa_lwt_log</a></h3><h2>ppx syntax extension</h2><h3><a href=".././api/Ppx_lwt" class="ocsimore_phrasing_link">Ppx_lwt</a></h3><h2>Miscellaneous</h2><h3><a href=".././api/Lwt_glib" class="ocsimore_phrasing_link">Lwt_glib</a></h3><h3><a href=".././api/Lwt_preemptive" class="ocsimore_phrasing_link">Lwt_preemptive</a></h3><h3><a href=".././api/Lwt_ssl" class="ocsimore_phrasing_link">Lwt_ssl</a></h3><h2>Index</h2><h3> <span><a href=".././api/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/index_attributes">Index of class attributes</a></span></h3><h3> <span><a href=".././api/index_methods">Index of class methods</a></span></h3><h3> <span><a href=".././api/index_classes">Index of classes</a></span></h3><h3> <span><a href=".././api/index_class_types">Index of class types</a></span></h3><h3> <span><a href=".././api/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/index_module_types">Index of module types</a></span></h3></nav></nav><article class="rightcol"><h1>Module <span><a href=".././api/Lwt_io">Lwt_io</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span class="ocsforge_color_uid"><span class="ocsforge_color_uid">Lwt_io</span></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a href=".././api/Lwt_io">..</a></span><span class="ocsforge_color_keyword">end</span></pre><p>Buffered byte channels
</p><hr/><p>A <strong>channel</strong> is a high-level object for performing input/output
(IO). It allows to read/write from/to the outside world in an
efficient way, by minimising the number of system calls.
</p><p>An <strong>output channel</strong> is used to send data and an <strong>input
channel</strong> is used to receive data.
</p><p>If you are familiar with buffered channels you may be familiar too
with the <strong>flush</strong> operation. Note that byte channels of this
module are automatically flushed when there is nothing else to do
(i.e. before the program becomes idle), so this means that you no
longer have to write:
</p><p>
</p><pre class=""><code class="language-ocaml translatable">eprintf &quot;log message\n&quot;;
      flush stderr;</code></pre><p>to have your messages displayed.
</p><p>Note about errors: input functions of this module raise
<span class="odocwiki_inlinecode">End_of_file</span> when the end-of-file is reached (i.e. when the read
function returns <span class="odocwiki_inlinecode">0</span>). Other exceptions are ones caused by the
backend read/write functions, such as <span class="odocwiki_inlinecode">Unix.Unix_error</span>.
</p><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONChannel_closed"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">Channel_closed</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string</span></pre><div class="odocwiki_info"><p>Exception raised when a channel is closed. The parameter is a
description of the channel.</p></div><h2 id="2_Types">Types <a class="backref" href="#2_Types">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="TYPEchannel"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type">'mode</span> <span class="odocwiki_name">channel</span></pre><div class="odocwiki_info"><p>Type of buffered byte channels</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEinput"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">input</span></pre><div class="odocwiki_info"><p>Input mode</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEoutput"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">output</span></pre><div class="odocwiki_info"><p>Output mode</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEmode"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type">'a</span> <span class="odocwiki_name">mode</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_variants"><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Input</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Output</span></span></span></span></pre><div class="odocwiki_info"><p>Channel mode</p></div><pre class="ocsforge_color odocwiki_code" id="VALinput"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">input</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput">input</a></span> <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">input</span> input mode representation</p></div><pre class="ocsforge_color odocwiki_code" id="VALoutput"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">output</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput">output</a></span> <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">output</span> output mode representation</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEinput_channel"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">input_channel</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput">input</a></span> <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span></span></pre><div class="odocwiki_info"><p>Type of input channels</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEoutput_channel"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">output_channel</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput">output</a></span> <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span></span></pre><div class="odocwiki_info"><p>Type of output channels</p></div><pre class="ocsforge_color odocwiki_code" id="VALmode"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">mode</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">mode ch</span> returns the mode of a channel</p></div><h2 id="2_Wellknowninstances">Well-known instances <a class="backref" href="#2_Wellknowninstances">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="VALstdin"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">stdin</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span></span></pre><div class="odocwiki_info"><p>The standard input, it reads data from <span><a href=".././api/Lwt_unix#VALstdin">Lwt_unix.stdin</a></span></p></div><pre class="ocsforge_color odocwiki_code" id="VALstdout"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">stdout</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span></span></pre><div class="odocwiki_info"><p>The standard output, it writes data to <span><a href=".././api/Lwt_unix#VALstdout">Lwt_unix.stdout</a></span></p></div><pre class="ocsforge_color odocwiki_code" id="VALstderr"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">stderr</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span></span></pre><div class="odocwiki_info"><p>The standard output for error messages, it writes data to
<span><a href=".././api/Lwt_unix#VALstderr">Lwt_unix.stderr</a></span></p></div><pre class="ocsforge_color odocwiki_code" id="VALzero"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">zero</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span></span></pre><div class="odocwiki_info"><p>Inputs which returns always <span class="odocwiki_inlinecode">'\x00'</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALnull"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">null</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span></span></pre><div class="odocwiki_info"><p>Output which drops everything</p></div><h2 id="2_Channelscreationmanipulation">Channels creation/manipulation <a class="backref" href="#2_Channelscreationmanipulation">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="VALpipe"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">pipe</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> * <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">pipe ?buffer_size ()</span> creates a pipe using <span><a href=".././api/Lwt_unix#VALpipe">Lwt_unix.pipe</a></span> and
makes two channels from the two returned file descriptors</p></div><pre class="ocsforge_color odocwiki_code" id="VALmake"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">make</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?close:</span><span class="ocsforge_color_delimiter">(</span>unit <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?seek:</span><span class="ocsforge_color_delimiter">(</span>int64 <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">seek_command</span> <span class="ocsforge_color_delimiter">-&gt;</span> int64 <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">mode:</span>'mode <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_delimiter">(</span><span><a href=".././api/Lwt_bytes#TYPEt">Lwt_bytes.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'mode <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">make ?buffer_size ?close ~mode perform_io</span> is the
main function for creating new channels.</p></div><div class="odocwiki_param_info"><p><span class="code">buffer_size</span> : size of the internal buffer. It must be
between 16 and <span class="odocwiki_inlinecode">Sys.max_string_length</span></p></div><div class="odocwiki_param_info"><p><span class="code">close</span> : close function of the channel. It defaults to
<span class="odocwiki_inlinecode">Lwt.return</span></p></div><div class="odocwiki_param_info"><p><span class="code">seek</span> : same meaning as <span class="odocwiki_inlinecode">Unix.lseek</span></p></div><div class="odocwiki_param_info"><p><span class="code">mode</span> : either <span><a href=".././api/Lwt_io#VALinput">Lwt_io.input</a></span> or <span><a href=".././api/Lwt_io#VALoutput">Lwt_io.output</a></span></p></div><pre class="ocsforge_color odocwiki_code" id="VALof_bytes"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">of_bytes</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">mode:</span>'mode <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/Lwt_bytes#TYPEt">Lwt_bytes.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'mode <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span></span></pre><div class="odocwiki_info"><p>Create a channel from a byte array. Reading/writing is done
directly on the provided array.</p></div><pre class="ocsforge_color odocwiki_code" id="VALof_fd"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">of_fd</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?close:</span><span class="ocsforge_color_delimiter">(</span>unit <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">mode:</span>'mode <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/Lwt_unix#TYPEfile_descr">Lwt_unix.file_descr</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'mode <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">of_fd ?buffer_size ?close ~mode fd</span> creates a channel from a
file descriptor.</p></div><div class="odocwiki_param_info"><p><span class="code">close</span> : defaults to closing the file descriptor.</p></div><pre class="ocsforge_color odocwiki_code" id="VALof_unix_fd"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">of_unix_fd</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?close:</span><span class="ocsforge_color_delimiter">(</span>unit <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">mode:</span>'mode <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">file_descr</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'mode <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">of_unix_fd ?buffer_size ?close ~mode fd</span> is a short-hand for:
</p><p><span class="odocwiki_inlinecode">of_fd ?buffer_size ?close (Lwt_unix.of_unix_file_descr fd)</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALclose"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">close</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">close ch</span> closes the given channel. If <span class="odocwiki_inlinecode">ch</span> is an output
channel, it performs all pending actions, flushes it and closes
it. If <span class="odocwiki_inlinecode">ch</span> is an input channel, it just closes it immediately.
</p><p><span class="odocwiki_inlinecode">close</span> returns the result of the close function of the
channel. Multiple calls to <span class="odocwiki_inlinecode">close</span> will return exactly the same
value.
</p><p>Note: you cannot use <span class="odocwiki_inlinecode">close</span> on channels obtained with
<span><a href=".././api/Lwt_io#VALatomic">Lwt_io.atomic</a></span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALabort"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">abort</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">abort ch</span> abort current operations and close the channel
immediately.</p></div><pre class="ocsforge_color odocwiki_code" id="VALatomic"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">atomic</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">atomic f</span> transforms a sequence of io operations into one
single atomic io operation.
</p><p>Note:
</p><ul><li> the channel passed to <span class="odocwiki_inlinecode">f</span> is invalid after <span class="odocwiki_inlinecode">f</span> terminates
</li><li> <span class="odocwiki_inlinecode">atomic</span> can be called inside another <span class="odocwiki_inlinecode">atomic</span></li></ul></div><pre class="ocsforge_color odocwiki_code" id="VALfile_length"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">file_length</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> int64 <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p>Returns the length of a file</p></div><pre class="ocsforge_color odocwiki_code" id="VALbuffered"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">buffered</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int</span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">buffered oc</span> returns the number of bytes in the buffer</p></div><pre class="ocsforge_color odocwiki_code" id="VALflush"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">flush</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">flush oc</span> performs all pending writes on <span class="odocwiki_inlinecode">oc</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALflush_all"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">flush_all</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">flush_all ()</span> flushes all open output channels</p></div><pre class="ocsforge_color odocwiki_code" id="VALbuffer_size"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">buffer_size</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int</span></pre><div class="odocwiki_info"><p>Returns the size of the internal buffer.</p></div><pre class="ocsforge_color odocwiki_code" id="VALresize_buffer"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">resize_buffer</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p>Resize the internal buffer to the given size</p></div><pre class="ocsforge_color odocwiki_code" id="VALis_busy"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">is_busy</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> bool</span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">is_busy channel</span> returns whether the given channel is currently
busy. A channel is busy when there is at least one job using it
that has not yet terminated.</p></div><h2 id="2_Randomaccess">Random access <a class="backref" href="#2_Randomaccess">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="VALposition"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">position</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int64</span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">position ch</span> Returns the current position in the channel.</p></div><pre class="ocsforge_color odocwiki_code" id="VALset_position"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">set_position</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int64 <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">set_position ch pos</span> Sets the position in the output channel. This
does not work if the channel does not support random access.</p></div><pre class="ocsforge_color odocwiki_code" id="VALlength"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">length</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int64 <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p>Returns the length of the channel in bytes</p></div><h2 id="2_Reading">Reading <a class="backref" href="#2_Reading">&#182;</a></h2><p>Note: except for functions dealing with streams (<span><a href=".././api/Lwt_io#VALread_chars">Lwt_io.read_chars</a></span> and
<span><a href=".././api/Lwt_io#VALread_lines">Lwt_io.read_lines</a></span>) all functions are <strong>atomic</strong>.
</p><pre class="ocsforge_color odocwiki_code" id="VALread_char"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_char</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read_char ic</span> reads the next character of <span class="odocwiki_inlinecode">ic</span>.
<strong>Raises</strong> <span class="teletype">End_of_file</span> if the end of the file is reached<br/></p></div><pre class="ocsforge_color odocwiki_code" id="VALread_char_opt"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_char_opt</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char option <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p>Same as <span class="odocwiki_inlinecode">read_byte</span> but does not raise <span class="odocwiki_inlinecode">End_of_file</span> on end of
input</p></div><pre class="ocsforge_color odocwiki_code" id="VALread_chars"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_chars</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read_chars ic</span> returns a stream holding all characters of
<span class="odocwiki_inlinecode">ic</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALread_line"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_line</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read_line ic</span> reads one complete line from <span class="odocwiki_inlinecode">ic</span> and returns it
without the end of line. End of line is either <span class="odocwiki_inlinecode">&quot;\n&quot;</span> or
<span class="odocwiki_inlinecode">&quot;\r\n&quot;</span>.
</p><p>If the end of line is reached before reading any character,
<span class="odocwiki_inlinecode">End_of_file</span> is raised. If it is reached before reading an end
of line but characters have already been read, they are
returned.</p></div><pre class="ocsforge_color odocwiki_code" id="VALread_line_opt"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_line_opt</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string option <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p>Same as <span><a href=".././api/Lwt_io#VALread_line">Lwt_io.read_line</a></span> but do not raise <span class="odocwiki_inlinecode">End_of_file</span> on end of
input.</p></div><pre class="ocsforge_color odocwiki_code" id="VALread_lines"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_lines</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read_lines ic</span> returns a stream holding all lines of <span class="odocwiki_inlinecode">ic</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALread"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">?count:</span>int <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read ?count ic</span> reads at most <span class="odocwiki_inlinecode">len</span> characters from <span class="odocwiki_inlinecode">ic</span>. It
returns <span class="odocwiki_inlinecode">&quot;&quot;</span> if the end of input is reached. If <span class="odocwiki_inlinecode">count</span> is not
specified, it reads all bytes until the end of input.</p></div><pre class="ocsforge_color odocwiki_code" id="VALread_into"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_into</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_uid">Bytes</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read_into ic buffer offset length</span> reads up to <span class="odocwiki_inlinecode">length</span> bytes,
stores them in <span class="odocwiki_inlinecode">buffer</span> at offset <span class="odocwiki_inlinecode">offset</span>, and returns the
number of bytes read.
</p><p>Note: <span class="odocwiki_inlinecode">read_into</span> does not raise <span class="odocwiki_inlinecode">End_of_file</span>, it returns a
length of <span class="odocwiki_inlinecode">0</span> instead.</p></div><pre class="ocsforge_color odocwiki_code" id="VALread_into_exactly"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_into_exactly</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_uid">Bytes</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read_into_exactly ic buffer offset length</span> reads exactly
<span class="odocwiki_inlinecode">length</span> bytes and stores them in <span class="odocwiki_inlinecode">buffer</span> at offset <span class="odocwiki_inlinecode">offset</span>.
<strong>Raises</strong> <span class="teletype">End_of_file</span> on end of input<br/></p></div><pre class="ocsforge_color odocwiki_code" id="VALread_value"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">read_value</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">read_value ic</span> reads a marshaled value from <span class="odocwiki_inlinecode">ic</span></p></div><h2 id="2_Writing">Writing <a class="backref" href="#2_Writing">&#182;</a></h2><p>Note: as for reading functions, all functions except
<span><a href=".././api/Lwt_io#VALwrite_chars">Lwt_io.write_chars</a></span> and <span><a href=".././api/Lwt_io#VALwrite_lines">Lwt_io.write_lines</a></span> are <strong>atomic</strong>.
</p><p>For example if you use <span><a href=".././api/Lwt_io#VALwrite_line">Lwt_io.write_line</a></span> in two different threads, the
two operations will be serialized, and lines cannot be mixed.
</p><pre class="ocsforge_color odocwiki_code" id="VALwrite_char"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_char</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write_char oc char</span> writes <span class="odocwiki_inlinecode">char</span> on <span class="odocwiki_inlinecode">oc</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_chars"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_chars</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write_chars oc chars</span> writes all characters of <span class="odocwiki_inlinecode">chars</span> on
<span class="odocwiki_inlinecode">oc</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write oc str</span> writes all characters of <span class="odocwiki_inlinecode">str</span> on <span class="odocwiki_inlinecode">oc</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_line"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_line</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write_line oc str</span> writes <span class="odocwiki_inlinecode">str</span> on <span class="odocwiki_inlinecode">oc</span> followed by a
new-line.</p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_lines"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_lines</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write_lines oc lines</span> writes all lines of <span class="odocwiki_inlinecode">lines</span> to <span class="odocwiki_inlinecode">oc</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_from"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_from</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_uid">Bytes</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write_from oc buffer offset length</span> writes up to <span class="odocwiki_inlinecode">length</span> bytes
to <span class="odocwiki_inlinecode">oc</span>, from <span class="odocwiki_inlinecode">buffer</span> at offset <span class="odocwiki_inlinecode">offset</span> and returns the number
of bytes actually written</p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_from_string"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_from_string</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p>See <span><a href=".././api/Lwt_io#VALwrite">Lwt_io.write</a></span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_from_exactly"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_from_exactly</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_uid">Bytes</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write_from_exactly oc buffer offset length</span> writes all <span class="odocwiki_inlinecode">length</span>
bytes from <span class="odocwiki_inlinecode">buffer</span> at offset <span class="odocwiki_inlinecode">offset</span> to <span class="odocwiki_inlinecode">oc</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_from_string_exactly"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_from_string_exactly</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p>See <span><a href=".././api/Lwt_io#VALwrite_from_exactly">Lwt_io.write_from_exactly</a></span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALwrite_value"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">write_value</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?flags:</span><span class="ocsforge_color_uid">Marshal</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">extern_flags</span> list <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">write_value oc ?flags x</span> marshals the value <span class="odocwiki_inlinecode">x</span> to <span class="odocwiki_inlinecode">oc</span></p></div><h2 id="2_Printing">Printing <a class="backref" href="#2_Printing">&#182;</a></h2><p>These functions are basically helpers. Also you may prefer
using the name <span><a href=".././api/Lwt_io#VALprintl">Lwt_io.printl</a></span> rather than <span><a href=".././api/Lwt_io#VALwrite_line">Lwt_io.write_line</a></span> because it is
shorter.
</p><p>The general name of a printing function is <span class="odocwiki_inlinecode">&lt;prefix&gt;print&lt;suffixes&gt;</span>,
</p><p>where <span class="odocwiki_inlinecode">&lt;prefix&gt;</span> is one of:
</p><ul><li> <span class="odocwiki_inlinecode">'f'</span>, which means that the function takes as argument a channel
</li><li> nothing, which means that the function prints on <span><a href=".././api/Lwt_io#VALstdout">Lwt_io.stdout</a></span>
</li><li> <span class="odocwiki_inlinecode">'e'</span>, which means that the function prints on <span><a href=".././api/Lwt_io#VALstderr">Lwt_io.stderr</a></span>
</li></ul><p>and <span class="odocwiki_inlinecode">&lt;suffixes&gt;</span> is a combination of:
</p><ul><li> <span class="odocwiki_inlinecode">'l'</span> which means that a new-line character is printed after the message
</li><li> <span class="odocwiki_inlinecode">'f'</span> which means that the function takes as argument a <strong>format</strong> instead
of a string
</li></ul><pre class="ocsforge_color odocwiki_code" id="VALfprint"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">fprint</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALfprintl"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">fprintl</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALfprintf"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">fprintf</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_delimiter">(</span>'a, unit, string, unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Pervasives</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">format4</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a</span></pre><pre class="ocsforge_color odocwiki_code" id="VALfprintlf"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">fprintlf</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_delimiter">(</span>'a, unit, string, unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Pervasives</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">format4</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a</span></pre><pre class="ocsforge_color odocwiki_code" id="VALprint"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">print</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALprintl"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">printl</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALprintf"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">printf</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, unit, string, unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Pervasives</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">format4</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a</span></pre><pre class="ocsforge_color odocwiki_code" id="VALprintlf"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">printlf</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, unit, string, unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Pervasives</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">format4</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a</span></pre><pre class="ocsforge_color odocwiki_code" id="VALeprint"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">eprint</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALeprintl"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">eprintl</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALeprintf"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">eprintf</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, unit, string, unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Pervasives</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">format4</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a</span></pre><pre class="ocsforge_color odocwiki_code" id="VALeprintlf"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">eprintlf</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, unit, string, unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Pervasives</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">format4</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a</span></pre><h2 id="2_Utilities">Utilities <a class="backref" href="#2_Utilities">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="VALhexdump_stream"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">hexdump_stream</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">hexdump_stream oc byte_stream</span> produces the same output as the
command <span class="odocwiki_inlinecode">hexdump -C</span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALhexdump"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">hexdump</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">hexdump oc str = hexdump_stream oc (Lwt_stream.of_string str)</span></p></div><h2 id="2_Fileutilities">File utilities <a class="backref" href="#2_Fileutilities">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="TYPEfile_name"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">file_name</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_type">string</span></pre><div class="odocwiki_info"><p>Type of file names</p></div><pre class="ocsforge_color odocwiki_code" id="VALopen_file"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">open_file</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?flags:</span><span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">open_flag</span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?perm:</span><span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">file_perm</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">mode:</span>'a <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/Lwt_io#TYPEfile_name">file_name</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">open_file ?buffer_size ?flags ?perm ~mode filename</span> opens the
file with name <span class="odocwiki_inlinecode">filename</span> and returns a channel for
reading/writing it.
<strong>Raises</strong> <span class="teletype">Unix.Unix_error</span> on error.<br/></p></div><pre class="ocsforge_color odocwiki_code" id="VALwith_file"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">with_file</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?flags:</span><span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">open_flag</span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?perm:</span><span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">file_perm</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">mode:</span>'a <span><a href=".././api/Lwt_io#TYPEmode">mode</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span><a href=".././api/Lwt_io#TYPEfile_name">file_name</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span>'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">with_file ?buffer_size ?flags ?perm ~mode filename f</span> opens a
file and passes the channel to <span class="odocwiki_inlinecode">f</span>. It is ensured that the
channel is closed when <span class="odocwiki_inlinecode">f ch</span> terminates (even if it fails).</p></div><pre class="ocsforge_color odocwiki_code" id="VALopen_connection"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">open_connection</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?fd:</span><span><a href=".././api/Lwt_unix#TYPEfile_descr">Lwt_unix.file_descr</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">sockaddr</span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> * <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span><span class="ocsforge_color_delimiter">)</span> <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">open_connection ?fd ?buffer_size addr</span> opens a connection to the
given address and returns two channels for using it. If <span class="odocwiki_inlinecode">fd</span> is
not specified, a fresh one will be used.
</p><p>The connection is completly closed when you close both
channels.
<strong>Raises</strong> <span class="teletype">Unix.Unix_error</span> on error.<br/></p></div><pre class="ocsforge_color odocwiki_code" id="VALwith_connection"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">with_connection</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?fd:</span><span><a href=".././api/Lwt_unix#TYPEfile_descr">Lwt_unix.file_descr</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">sockaddr</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_delimiter">(</span><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> * <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">with_connection ?fd ?buffer_size addr f</span> opens a connection to
the given address and passes the channels to <span class="odocwiki_inlinecode">f</span></p></div><pre class="ocsforge_color odocwiki_code" id="TYPEserver"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">server</span></pre><div class="odocwiki_info"><p>Type of a server</p></div><pre class="ocsforge_color odocwiki_code" id="VALestablish_server"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">establish_server</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?fd:</span><span><a href=".././api/Lwt_unix#TYPEfile_descr">Lwt_unix.file_descr</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?buffer_size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?backlog:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_uid">Unix</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">sockaddr</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_delimiter">(</span><span><a href=".././api/Lwt_io#TYPEinput_channel">input_channel</a></span> * <span><a href=".././api/Lwt_io#TYPEoutput_channel">output_channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit<span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span><a href=".././api/Lwt_io#TYPEserver">server</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">establish_server ?fd ?buffer_size ?backlog sockaddr f</span> creates a
server which will listen for incoming connections. New connections
are passed to <span class="odocwiki_inlinecode">f</span>. Note that <span class="odocwiki_inlinecode">f</span> must not raise any exception. If
<span class="odocwiki_inlinecode">fd</span> is not specified, a fresh file descriptor will be created.
</p><p><span class="odocwiki_inlinecode">backlog</span> is the argument passed to <span class="odocwiki_inlinecode">Lwt_unix.listen</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALshutdown_server"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">shutdown_server</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEserver">server</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p>Shutdown the given server</p></div><pre class="ocsforge_color odocwiki_code" id="VALlines_of_file"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">lines_of_file</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEfile_name">file_name</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">lines_of_file name</span> returns a stream of all lines of the file
with name <span class="odocwiki_inlinecode">name</span>. The file is automatically closed when all
lines have been read.</p></div><pre class="ocsforge_color odocwiki_code" id="VALlines_to_file"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">lines_to_file</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEfile_name">file_name</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">lines_to_file name lines</span> writes all lines of <span class="odocwiki_inlinecode">lines</span> to
file with name <span class="odocwiki_inlinecode">name</span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALchars_of_file"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">chars_of_file</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEfile_name">file_name</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">chars_of_file name</span> returns a stream of all characters of the
file with name <span class="odocwiki_inlinecode">name</span>. As for <span><a href=".././api/Lwt_io#VALlines_of_file">Lwt_io.lines_of_file</a></span> the file is
closed when all characters have been read.</p></div><pre class="ocsforge_color odocwiki_code" id="VALchars_to_file"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">chars_to_file</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEfile_name">file_name</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> char <span><a href=".././api/Lwt_stream#TYPEt">Lwt_stream.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">chars_to_file name chars</span> writes all characters of <span class="odocwiki_inlinecode">chars</span> to
<span class="odocwiki_inlinecode">name</span></p></div><h2 id="2_Inputoutputofintegers">Input/output of integers <a class="backref" href="#2_Inputoutputofintegers">&#182;</a></h2><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module type</span> <span><a href=".././api/Lwt_io.NumberIO">NumberIO</a></span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_keyword">sig</span><span><a href=".././api/Lwt_io.NumberIO">..</a></span><span class="ocsforge_color_keyword">end</span></pre><div class="odocwiki_info"><p>Common interface for reading/writing integers in binary</p></div><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a href=".././api/Lwt_io.LE">LE</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io.NumberIO">NumberIO</a></span></span><span class="odocwiki_type"></span></pre><div class="odocwiki_info"><p>Reading/writing of numbers in little-endian</p></div><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a href=".././api/Lwt_io.BE">BE</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io.NumberIO">NumberIO</a></span></span><span class="odocwiki_type"></span></pre><div class="odocwiki_info"><p>Reading/writing of numbers in big-endian</p></div><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">include</span> <span><a href=".././api/Lwt_io.NumberIO">Lwt_io.NumberIO</a></span></pre><p>Reading/writing of numbers in the system endianness.
</p><pre class="ocsforge_color odocwiki_code" id="TYPEbyte_order"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">byte_order</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_sys#TYPEbyte_order">Lwt_sys.byte_order</a></span></span>  <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_variants"><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Little_endian</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Big_endian</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>&lt;&lt;div class=&quot;odocwiki_info&quot;|~Type of byte order
&gt;&gt;</span><span class="odocwiki_comments_close"> *)</span></span></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALsystem_byte_order"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">system_byte_order</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_io#TYPEbyte_order">byte_order</a></span></span></pre><div class="odocwiki_info"><p>Same as <span><a href=".././api/Lwt_sys#VALbyte_order">Lwt_sys.byte_order</a></span>.</p></div><h2 id="2_Lowlevelaccesstotheinternalbuffer">Low-level access to the internal buffer <a class="backref" href="#2_Lowlevelaccesstotheinternalbuffer">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="VALblock"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">block</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  int <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span><span><a href=".././api/Lwt_bytes#TYPEt">Lwt_bytes.t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> int <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">block ch size f</span> pass to <span class="odocwiki_inlinecode">f</span> the internal buffer and an
offset. The buffer contains <span class="odocwiki_inlinecode">size</span> chars at <span class="odocwiki_inlinecode">offset</span>. <span class="odocwiki_inlinecode">f</span> may
read or write these chars.  <span class="odocwiki_inlinecode">size</span> must satisfy <span class="odocwiki_inlinecode">0 &lt;= size &lt;=
16</span></p></div><pre class="ocsforge_color odocwiki_code" id="TYPEdirect_access"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">direct_access</span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_delimiter">{</span>
<span class="odocwiki_record"><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">da_buffer:</span> <span class="odocwiki_type"><span><a href=".././api/Lwt_bytes#TYPEt">Lwt_bytes.t</a></span></span><span class="ocsforge_color_delimiter">;</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>&lt;&lt;div class=&quot;odocwiki_info&quot;|~The internal buffer
&gt;&gt;</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_keyword">mutable </span><span class="ocsforge_color_label">da_ptr:</span> <span class="odocwiki_type">int</span><span class="ocsforge_color_delimiter">;</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>&lt;&lt;div class=&quot;odocwiki_info&quot;|~The pointer to~:
* the beginning of free space for output channels
* the beginning of data for input channels

&gt;&gt;</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_keyword">mutable </span><span class="ocsforge_color_label">da_max:</span> <span class="odocwiki_type">int</span><span class="ocsforge_color_delimiter">;</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>&lt;&lt;div class=&quot;odocwiki_info&quot;|~The maximum offset
&gt;&gt;</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">da_perform:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> int <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span><span class="ocsforge_color_delimiter">;</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>&lt;&lt;div class=&quot;odocwiki_info&quot;|~- for input channels~:
        refills the buffer and returns how many bytes have been read
* for output channels~:
        flush partially the buffer and returns how many bytes have been written

&gt;&gt;</span><span class="odocwiki_comments_close"> *)</span></span></span></span><span class="ocsforge_color_delimiter">}</span></pre><div class="odocwiki_info"><p>Information for directly accessing the internal buffer of a
channel</p></div><pre class="ocsforge_color odocwiki_code" id="VALdirect_access"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">direct_access</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a href=".././api/Lwt_io#TYPEchannel">channel</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span><span><a href=".././api/Lwt_io#TYPEdirect_access">direct_access</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span><a href=".././api/Lwt#TYPEt">Lwt.t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">direct_access ch f</span> passes to <span class="odocwiki_inlinecode">f</span> a <span><a href=".././api/Lwt_io#VALdirect_access">Lwt_io.direct_access</a></span>
structure. <span class="odocwiki_inlinecode">f</span> must use it and update <span class="odocwiki_inlinecode">da_ptr</span> to reflect how
many bytes have been read/written.</p></div><h2 id="2_Misc">Misc <a class="backref" href="#2_Misc">&#182;</a></h2><pre class="ocsforge_color odocwiki_code" id="VALdefault_buffer_size"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">default_buffer_size</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> int</span></pre><div class="odocwiki_info"><p>Return the default size for buffers. Channels that are created
without a specific size use this one.</p></div><pre class="ocsforge_color odocwiki_code" id="VALset_default_buffer_size"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">set_default_buffer_size</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">int <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p>Change the default buffer size.
<strong>Raises</strong> <span class="teletype">Invalid_argument</span> if the given size is smaller than <span class="odocwiki_inlinecode">16</span>
or greater than <span class="odocwiki_inlinecode">Sys.max_string_length</span><br/></p></div></article></div></div></body></html>
